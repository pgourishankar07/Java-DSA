>>>lib/constants.ts
export const navItems = [
Â  {
Â  Â  name: "Home",
Â  Â  href: "/",
Â  },
Â  {
Â  Â  name: "Dashboard",
Â  Â  href: "/dashboard",
Â  },
Â  {
Â  Â  name: "About",
Â  Â  href: "/about",
Â  },
Â  {
Â  Â  name: "",
Â  Â  href: "",
Â  Â  items: [{ name: "", href: "" }]
Â  }
];

>>>lib/data.ts
export const categories = [
Â  {
Â  Â  name: "Agriculture",
Â  Â  icon: `<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-wheat-icon lucide-wheat"><path d="M2 22 16 8"/><path d="M3.47 12.53 5 11l1.53 1.53a3.5 3.5 0 0 1 0 4.94L5 19l-1.53-1.53a3.5 3.5 0 0 1 0-4.94Z"/><path d="M7.47 8.53 9 7l1.53 1.53a3.5 3.5 0 0 1 0 4.94L9 15l-1.53-1.53a3.5 3.5 0 0 1 0-4.94Z"/><path d="M11.47 4.53 13 3l1.53 1.53a3.5 3.5 0 0 1 0 4.94L13 11l-1.53-1.53a3.5 3.5 0 0 1 0-4.94Z"/><path d="M20 2h2v2a4 4 0 0 1-4 4h-2V6a4 4 0 0 1 4-4Z"/><path d="M11.47 17.47 13 19l-1.53 1.53a3.5 3.5 0 0 1-4.94 0L5 19l1.53-1.53a3.5 3.5 0 0 1 4.94 0Z"/><path d="M15.47 13.47 17 15l-1.53 1.53a3.5 3.5 0 0 1-4.94 0L9 15l1.53-1.53a3.5 3.5 0 0 1 4.94 0Z"/><path d="M19.47 9.47 21 11l-1.53 1.53a3.5 3.5 0 0 1-4.94 0L13 11l1.53-1.53a3.5 3.5 0 0 1 4.94 0Z"/></svg>`,

Â  },
Â  {
Â  Â  name: "Meat & Poultry",
Â  Â  icon: `<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-beef-icon lucide-beef"><path d="M16.4 13.7A6.5 6.5 0 1 0 6.28 6.6c-1.1 3.13-.78 3.9-3.18 6.08A3 3 0 0 0 5 18c4 0 8.4-1.8 11.4-4.3"/><path d="m18.5 6 2.19 4.5a6.48 6.48 0 0 1-2.29 7.2C15.4 20.2 11 22 7 22a3 3 0 0 1-2.68-1.66L2.4 16.5"/><circle cx="12.5" cy="8.5" r="2.5"/></svg>`,
Â  },
Â  {
Â  Â  name: "Animal Nutrition",
Â  Â  icon: `<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-bone-icon lucide-bone"><path d="M17 10c.7-.7 1.69 0 2.5 0a2.5 2.5 0 1 0 0-5 .5.5 0 0 1-.5-.5 2.5 2.5 0 1 0-5 0c0 .81.7 1.8 0 2.5l-7 7c-.7.7-1.69 0-2.5 0a2.5 2.5 0 0 0 0 5c.28 0 .5.22.5.5a2.5 2.5 0 1 0 5 0c0-.81-.7-1.8 0-2.5Z"/></svg>`,
Â  },
Â  {
Â  Â  name: "Beauty",
Â  Â  icon: `<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-smile-plus-icon lucide-smile-plus"><path d="M22 11v1a10 10 0 1 1-9-10"/><path d="M8 14s1.5 2 4 2 4-2 4-2"/><line x1="9" x2="9.01" y1="9" y2="9"/><line x1="15" x2="15.01" y1="9" y2="9"/><path d="M16 5h6"/><path d="M19 2v6"/></svg>`,
Â  Â  count: 12,
Â  },
Â  {
Â  Â  name: "Bioindustrial",
Â  Â  icon: `<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-biohazard-icon lucide-biohazard"><circle cx="12" cy="11.9" r="2"/><path d="M6.7 3.4c-.9 2.5 0 5.2 2.2 6.7C6.5 9 3.7 9.6 2 11.6"/><path d="m8.9 10.1 1.4.8"/><path d="M17.3 3.4c.9 2.5 0 5.2-2.2 6.7 2.4-1.2 5.2-.6 6.9 1.5"/><path d="m15.1 10.1-1.4.8"/><path d="M16.7 20.8c-2.6-.4-4.6-2.6-4.7-5.3-.2 2.6-2.1 4.8-4.7 5.2"/><path d="M12 13.9v1.6"/><path d="M13.5 5.4c-1-.2-2-.2-3 0"/><path d="M17 16.4c.7-.7 1.2-1.6 1.5-2.5"/><path d="M5.5 13.9c.3.9.8 1.8 1.5 2.5"/></svg>`,
Â  },
Â  {
Â  Â  name: "Food & Beverage",
Â  Â  icon: `<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-hamburger-icon lucide-hamburger"><path d="M12 16H4a2 2 0 1 1 0-4h16a2 2 0 1 1 0 4h-4.25"/><path d="M5 12a2 2 0 0 1-2-2 9 7 0 0 1 18 0 2 2 0 0 1-2 2"/><path d="M5 16a2 2 0 0 0-2 2 3 3 0 0 0 3 3h12a3 3 0 0 0 3-3 2 2 0 0 0-2-2q0 0 0 0"/><path d="m6.67 12 6.13 4.6a2 2 0 0 0 2.8-.4l3.15-4.2"/></svg>`,
Â  },
];

export const quotes = [
Â  {
Â  Â  text: "We believe big companies can and should do good.",
Â  Â  author: "Brian Sikes",
Â  },
Â  {
Â  Â  text: "At Cargill, everyone matters and everyone counts.",
Â  Â  author: "Brian Sikes",
Â  },
Â  {
Â  Â  text: "Our word is our bond.",
Â  Â  author: "Brian Sikes",
Â  },
Â  {
Â  Â  text: "Bringing access to life's essentials since 1865.",
Â  Â  author: "Brian Sikes",
Â  },
Â  {
Â  Â  text: "Nourishing the world in a safe, responsible and sustainable way.",
Â  Â  author: "Brian Sikes",
Â  },
];

>>>lib/dataLoader.ts
import Papa from 'papaparse';

export interface EnterpriseData {
Â  Â  id: string;
Â  Â  title: string;
Â  Â  icon: string;
Â  Â  color: string;
Â  Â  metrics: {
Â  Â  Â  Â  apps: number;
Â  Â  Â  Â  valueSavings: string;
Â  Â  Â  Â  vulnerabilities: number;
Â  Â  Â  Â  innovations: string;
Â  Â  Â  Â  p1: number;
Â  Â  };
Â  Â  items: BusinessUnitData[];
}

export interface BusinessUnitData {
Â  Â  name: string;
Â  Â  apps: number;
Â  Â  valueSavings: string;
Â  Â  vulnerabilities: number;
Â  Â  innovations: number;
Â  Â  p1: number;
Â  Â  appBreakdown?: {
Â  Â  Â  Â  platinum: number;
Â  Â  Â  Â  gold: number;
Â  Â  Â  Â  silver: number;
Â  Â  Â  Â  bronze: number;
Â  Â  Â  Â  lead: number;
Â  Â  };
}

export interface EnterpriseCSVRow {
Â  Â  'Enterprise ID': string;
Â  Â  'Enterprise Name': string;
Â  Â  'Icon': string;
Â  Â  'Color': string;
}

export interface BusinessUnitCSVRow {
Â  Â  'Enterprise ID': string;
Â  Â  'Business Unit Name': string;
Â  Â  'Apps': string;
Â  Â  'Value Savings': string;
Â  Â  'Vulnerabilities': string;
Â  Â  'Innovations': string;
Â  Â  'P1': string;
}

export interface ContractData {
Â  Â  id: string;
Â  Â  title: string;
Â  Â  client: string;
Â  Â  value: string;
Â  Â  startDate: string;
Â  Â  endDate: string;
Â  Â  status: string;
Â  Â  type: string;
Â  Â  region: string;
Â  Â  progress: number;
}

// Function to calculate enterprise totals from business unit metrics
function calculateEnterpriseMetrics(businessUnits: BusinessUnitData[]): {
Â  Â  apps: number;
Â  Â  valueSavings: string;
Â  Â  vulnerabilities: number;
Â  Â  innovations: string;
Â  Â  p1: number;
} {
Â  Â  const totalApps = businessUnits.reduce((sum, unit) => sum + unit.apps, 0);
Â  Â  const totalVulnerabilities = businessUnits.reduce((sum, unit) => sum + unit.vulnerabilities, 0);
Â  Â  const totalP1 = businessUnits.reduce((sum, unit) => sum + unit.p1, 0);

Â  Â  // Sum up value savings (remove $ and K, then add back)
Â  Â  const totalValueSavings = businessUnits.reduce((sum, unit) => {
Â  Â  Â  Â  const value = parseInt(unit.valueSavings.replace(/[$K]/g, ''));
Â  Â  Â  Â  return sum + value;
Â  Â  }, 0);

Â  Â  // Sum up innovations (remove +, then add back)
Â  Â  const totalInnovations = businessUnits.reduce((sum, unit) => {
Â  Â  Â  Â  return sum + unit.innovations;
Â  Â  }, 0);

Â  Â  return {
Â  Â  Â  Â  apps: totalApps,
Â  Â  Â  Â  valueSavings: `$${totalValueSavings}K`,
Â  Â  Â  Â  vulnerabilities: totalVulnerabilities,
Â  Â  Â  Â  innovations: `${totalInnovations}+`,
Â  Â  Â  Â  p1: totalP1
Â  Â  };
}

// Main function that loads data from API route
export async function loadEnterpriseData(): Promise<EnterpriseData[]> {
Â  Â  try {
Â  Â  Â  Â  // Load data from API route (which handles Excel/CSV on server side)
Â  Â  Â  Â  const response = await fetch('/api/enterprise-data');
Â  Â  Â  Â  if (!response.ok) {
Â  Â  Â  Â  Â  Â  throw new Error(`API request failed: ${response.status}`);
Â  Â  Â  Â  }
Â  Â  Â  Â  const data = await response.json();
Â  Â  Â  Â  return data;
Â  Â  } catch (error) {
Â  Â  Â  Â  console.error('Error loading enterprise data from API:', error);
Â  Â  Â  Â  // Fallback to CSV if API fails
Â  Â  Â  Â  return await loadEnterpriseDataFromCSV();
Â  Â  }
} export async function loadEnterpriseDataFromCSV(): Promise<EnterpriseData[]> {
Â  Â  try {
Â  Â  Â  Â  // Load enterprises CSV
Â  Â  Â  Â  const enterpriseResponse = await fetch('/data/enterprises.csv');
Â  Â  Â  Â  const enterpriseCSV = await enterpriseResponse.text();

Â  Â  Â  Â  // Load business units CSV
Â  Â  Â  Â  const businessUnitsResponse = await fetch('/data/business-units.csv');
Â  Â  Â  Â  const businessUnitsCSV = await businessUnitsResponse.text();

Â  Â  Â  Â  // Parse CSV data
Â  Â  Â  Â  const enterpriseResult = Papa.parse<EnterpriseCSVRow>(enterpriseCSV, {
Â  Â  Â  Â  Â  Â  header: true,
Â  Â  Â  Â  Â  Â  skipEmptyLines: true
Â  Â  Â  Â  });

Â  Â  Â  Â  const businessUnitsResult = Papa.parse<BusinessUnitCSVRow>(businessUnitsCSV, {
Â  Â  Â  Â  Â  Â  header: true,
Â  Â  Â  Â  Â  Â  skipEmptyLines: true
Â  Â  Â  Â  });

Â  Â  Â  Â  if (enterpriseResult.errors.length > 0) {
Â  Â  Â  Â  Â  Â  console.error('Enterprise CSV parsing errors:', enterpriseResult.errors);
Â  Â  Â  Â  }

Â  Â  Â  Â  if (businessUnitsResult.errors.length > 0) {
Â  Â  Â  Â  Â  Â  console.error('Business Units CSV parsing errors:', businessUnitsResult.errors);
Â  Â  Â  Â  }

Â  Â  Â  Â  // Group business units WITH METRICS by enterprise ID
Â  Â  Â  Â  const businessUnitsByEnterprise: { [key: string]: BusinessUnitData[] } = {};

Â  Â  Â  Â  businessUnitsResult.data.forEach(row => {
Â  Â  Â  Â  Â  Â  const enterpriseId = row['Enterprise ID'];
Â  Â  Â  Â  Â  Â  const unitData: BusinessUnitData = {
Â  Â  Â  Â  Â  Â  Â  Â  name: row['Business Unit Name'],
Â  Â  Â  Â  Â  Â  Â  Â  apps: parseInt(row['Apps']),
Â  Â  Â  Â  Â  Â  Â  Â  valueSavings: row['Value Savings'],
Â  Â  Â  Â  Â  Â  Â  Â  vulnerabilities: parseInt(row['Vulnerabilities']),
Â  Â  Â  Â  Â  Â  Â  Â  innovations: parseInt(row['Innovations']),
Â  Â  Â  Â  Â  Â  Â  Â  p1: parseInt(row['P1'])
Â  Â  Â  Â  Â  Â  };

Â  Â  Â  Â  Â  Â  if (!businessUnitsByEnterprise[enterpriseId]) {
Â  Â  Â  Â  Â  Â  Â  Â  businessUnitsByEnterprise[enterpriseId] = [];
Â  Â  Â  Â  Â  Â  }

Â  Â  Â  Â  Â  Â  businessUnitsByEnterprise[enterpriseId].push(unitData);
Â  Â  Â  Â  });

Â  Â  Â  Â  // Map enterprise data and CALCULATE TOTALS from business units
Â  Â  Â  Â  const enterpriseData: EnterpriseData[] = enterpriseResult.data.map(row => {
Â  Â  Â  Â  Â  Â  const enterpriseId = row['Enterprise ID'];

Â  Â  Â  Â  Â  Â  // Get business units for this enterprise
Â  Â  Â  Â  Â  Â  const businessUnits = businessUnitsByEnterprise[enterpriseId] || [];

Â  Â  Â  Â  Â  Â  // CALCULATE enterprise metrics from business unit totals
Â  Â  Â  Â  Â  Â  const calculatedMetrics = calculateEnterpriseMetrics(businessUnits);

Â  Â  Â  Â  Â  Â  return {
Â  Â  Â  Â  Â  Â  Â  Â  id: enterpriseId,
Â  Â  Â  Â  Â  Â  Â  Â  title: row['Enterprise Name'],
Â  Â  Â  Â  Â  Â  Â  Â  icon: row['Icon'],
Â  Â  Â  Â  Â  Â  Â  Â  color: row['Color'],
Â  Â  Â  Â  Â  Â  Â  Â  metrics: calculatedMetrics,
Â  Â  Â  Â  Â  Â  Â  Â  items: businessUnits
Â  Â  Â  Â  Â  Â  };
Â  Â  Â  Â  });

Â  Â  Â  Â  return enterpriseData;

Â  Â  } catch (error) {
Â  Â  Â  Â  console.error('Error loading CSV data:', error);
Â  Â  Â  Â  return [];
Â  Â  }
}

// Function to load contract data from Excel file via API
export async function loadContractData(): Promise<ContractData[]> {
Â  Â  console.log('ğŸ” Starting to load contract data from API...');

Â  Â  try {
Â  Â  Â  Â  // Fetch contract data from API route
Â  Â  Â  Â  const response = await fetch('/api/contract-data');

Â  Â  Â  Â  if (!response.ok) {
Â  Â  Â  Â  Â  Â  throw new Error(`API request failed: ${response.status} ${response.statusText}`);
Â  Â  Â  Â  }

Â  Â  Â  Â  const contracts = await response.json();
Â  Â  Â  Â  console.log('âœ… Successfully loaded', contracts.length, 'contracts from API');
Â  Â  Â  Â  console.log('ğŸ“Š Status distribution:', contracts.reduce((acc: { [key: string]: number }, contract: ContractData) => {
Â  Â  Â  Â  Â  Â  acc[contract.status] = (acc[contract.status] || 0) + 1;
Â  Â  Â  Â  Â  Â  return acc;
Â  Â  Â  Â  }, {}));

Â  Â  Â  Â  return contracts;
Â  Â  } catch (error) {
Â  Â  Â  Â  console.error('âŒ Error loading contract data from API:', error);

Â  Â  Â  Â  // Return fallback data if Excel loading fails
Â  Â  Â  Â  return [
Â  Â  Â  Â  Â  Â  {
Â  Â  Â  Â  Â  Â  Â  Â  id: "CTR-001",
Â  Â  Â  Â  Â  Â  Â  Â  title: "Grain Supply Agreement",
Â  Â  Â  Â  Â  Â  Â  Â  client: "Global Foods Inc.",
Â  Â  Â  Â  Â  Â  Â  Â  value: "$2.5M",
Â  Â  Â  Â  Â  Â  Â  Â  startDate: "2024-01-15",
Â  Â  Â  Â  Â  Â  Â  Â  endDate: "2025-01-14",
Â  Â  Â  Â  Â  Â  Â  Â  status: "Active",
Â  Â  Â  Â  Â  Â  Â  Â  type: "Supply",
Â  Â  Â  Â  Â  Â  Â  Â  region: "North America",
Â  Â  Â  Â  Â  Â  Â  Â  progress: 75,
Â  Â  Â  Â  Â  Â  },
Â  Â  Â  Â  Â  Â  {
Â  Â  Â  Â  Â  Â  Â  Â  id: "CTR-002",
Â  Â  Â  Â  Â  Â  Â  Â  title: "Logistics Partnership",
Â  Â  Â  Â  Â  Â  Â  Â  client: "Transport Solutions Ltd.",
Â  Â  Â  Â  Â  Â  Â  Â  value: "$1.8M",
Â  Â  Â  Â  Â  Â  Â  Â  startDate: "2024-03-01",
Â  Â  Â  Â  Â  Â  Â  Â  endDate: "2024-12-31",
Â  Â  Â  Â  Â  Â  Â  Â  status: "Active",
Â  Â  Â  Â  Â  Â  Â  Â  type: "Services",
Â  Â  Â  Â  Â  Â  Â  Â  region: "Europe",
Â  Â  Â  Â  Â  Â  Â  Â  progress: 60,
Â  Â  Â  Â  Â  Â  },
Â  Â  Â  Â  Â  Â  {
Â  Â  Â  Â  Â  Â  Â  Â  id: "CTR-003",
Â  Â  Â  Â  Â  Â  Â  Â  title: "Animal Feed Contract",
Â  Â  Â  Â  Â  Â  Â  Â  client: "Livestock Partners Co.",
Â  Â  Â  Â  Â  Â  Â  Â  value: "$3.2M",
Â  Â  Â  Â  Â  Â  Â  Â  startDate: "2024-02-10",
Â  Â  Â  Â  Â  Â  Â  Â  endDate: "2025-02-09",
Â  Â  Â  Â  Â  Â  Â  Â  status: "Active",
Â  Â  Â  Â  Â  Â  Â  Â  type: "Supply",
Â  Â  Â  Â  Â  Â  Â  Â  region: "Asia-Pacific",
Â  Â  Â  Â  Â  Â  Â  Â  progress: 85,
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  ];
Â  Â  }
}

// Icon mapping function
export function getIconComponent(iconName: string) {
Â  Â  // This will be imported and used in the main component
Â  Â  // We'll return the icon name for now and map it in the component
Â  Â  return iconName;
}

>>>lib/kpi-data.ts
export const kpiData = [
Â  Â  [
Â  Â  Â  Â  "KPI-1",
Â  Â  Â  Â  "AMSÂ  ",
Â  Â  Â  Â  "Incident Human Response Time - Personal Contact",
Â  Â  Â  Â  "Priority 1",
Â  Â  Â  Â  "Platinum & Gold",
Â  Â  Â  Â  "Measures the percentage of Priority 1 Incidents that were responded to by a Supplier personnel who is qualifiedÂ  & trained to resolve Priority 1 Incidents within 0.25 Clock Hours",
Â  Â  ],
Â  Â  [
Â  Â  Â  Â  "KPI-2",
Â  Â  Â  Â  "AMSÂ  ",
Â  Â  Â  Â  "Incident Human Response Time - Personal Contact",
Â  Â  Â  Â  "Priority 2",
Â  Â  Â  Â  "Platinum & Gold",
Â  Â  Â  Â  "Measures the percentage of Priority 2 Incidents that were responded to by a Supplier personnel who is qualifiedÂ  & trained to resolve Priority 2 Incidents within 1 Clock Hour",
Â  Â  ],
Â  Â  [
Â  Â  Â  Â  "KPI-3",
Â  Â  Â  Â  "AMSÂ  ",
Â  Â  Â  Â  "Incident Response Time - Assigned to an Individual",
Â  Â  Â  Â  "Priority 1Â  & 2",
Â  Â  Â  Â  "Platinum & Gold",
Â  Â  Â  Â  "Measures the percentage of Priority 1Â  & 2 Incidents that were assigned to the queÂ  & then placed into an in-progress state by an individual within 1 Clock Hour",
Â  Â  ],
Â  Â  [
Â  Â  Â  Â  "KPI-4",
Â  Â  Â  Â  "AMSÂ  ",
Â  Â  Â  Â  "Incident Response Time - Assigned to an Individual",
Â  Â  Â  Â  "Priority 1Â  & 2",
Â  Â  Â  Â  "Silver",
Â  Â  Â  Â  "Measures the percentage of Priority 1Â  & 2 Incidents that were assigned to the queÂ  & then placed into an in-progress state by an individual within 1 Clock Hour",
Â  Â  ],
Â  Â  [
Â  Â  Â  Â  "KPI-5",
Â  Â  Â  Â  "AMSÂ  ",
Â  Â  Â  Â  "Incident Response Time - Assigned to an Individual",
Â  Â  Â  Â  "Priority 3",
Â  Â  Â  Â  "Platinum & Gold",
Â  Â  Â  Â  "Measures the percentage of Priority 3 Incidents that were assigned to the queÂ  & then placed into an in-progress state by an individual within 1 Business Day",
Â  Â  ],
Â  Â  [
Â  Â  Â  Â  "KPI-6",
Â  Â  Â  Â  "AMSÂ  ",
Â  Â  Â  Â  "Incident Response Time - Assigned to an Individual",
Â  Â  Â  Â  "Priority 3",
Â  Â  Â  Â  "Silver & Bronze",
Â  Â  Â  Â  "Measures the percentage of Priority 3 Incidents that were assigned to the queÂ  & then placed into an in-progress state by an individual within 1 Business Day",
Â  Â  ],
Â  Â  [
Â  Â  Â  Â  "KPI-7",
Â  Â  Â  Â  "AMSÂ  ",
Â  Â  Â  Â  "Incident Response Time - Assigned to an Individual",
Â  Â  Â  Â  "Priority 4",
Â  Â  Â  Â  "Platinum & Gold",
Â  Â  Â  Â  "Measures the percentage of Priority 4 Incidents that were assigned to the queÂ  & then placed into an in-progress state by an individual within 2 Business Days",
Â  Â  ],
Â  Â  [
Â  Â  Â  Â  "KPI-8",
Â  Â  Â  Â  "AMSÂ  ",
Â  Â  Â  Â  "Incident Response Time - Assigned to an Individual",
Â  Â  Â  Â  "Priority 4",
Â  Â  Â  Â  "Silver & Bronze",
Â  Â  Â  Â  "Measures the percentage of Priority 4 Incidents that were assigned to the queÂ  & then placed into an in-progress state by an individual within 2 Business Days",
Â  Â  ],
Â  Â  [
Â  Â  Â  Â  "KPI-9",
Â  Â  Â  Â  "AMSÂ  ",
Â  Â  Â  Â  "Incident Closure Time",
Â  Â  Â  Â  "Priority 1",
Â  Â  Â  Â  "Platinum & Gold",
Â  Â  Â  Â  "Measures the percentage of Priority 1 Incidents that were closed within 24 Clock Hours",
Â  Â  ],
Â  Â  [
Â  Â  Â  Â  "KPI-10",
Â  Â  Â  Â  "AMSÂ  ",
Â  Â  Â  Â  "Incident Closure Time",
Â  Â  Â  Â  "Priority 1",
Â  Â  Â  Â  "Silver",
Â  Â  Â  Â  "Measures the percentage of Priority 1 Incidents that were closed within 24 Clock Hours",
Â  Â  ],
Â  Â  [
Â  Â  Â  Â  "KPI-11",
Â  Â  Â  Â  "AMSÂ  ",
Â  Â  Â  Â  "Incident Closure Time",
Â  Â  Â  Â  "Priority 2",
Â  Â  Â  Â  "Platinum & Gold",
Â  Â  Â  Â  "Measures the percentage of Priority 2 Incidents that were closed within 48 Clock Hours",
Â  Â  ],
Â  Â  [
Â  Â  Â  Â  "KPI-12",
Â  Â  Â  Â  "AMSÂ  ",
Â  Â  Â  Â  "Incident Closure Time",
Â  Â  Â  Â  "Priority 2",
Â  Â  Â  Â  "Silver",
Â  Â  Â  Â  "Measures the percentage of Priority 2 Incidents that were closed within 48 Clock Hours",
Â  Â  ],
Â  Â  [
Â  Â  Â  Â  "KPI-13",
Â  Â  Â  Â  "AMSÂ  ",
Â  Â  Â  Â  "Incident Closure Time",
Â  Â  Â  Â  "Priority 3",
Â  Â  Â  Â  "Platinum & Gold",
Â  Â  Â  Â  "Measures the percentage of Priority 3 Incidents that were closed within 10 Business Days",
Â  Â  ],
Â  Â  [
Â  Â  Â  Â  "KPI-14",
Â  Â  Â  Â  "AMSÂ  ",
Â  Â  Â  Â  "Incident Closure Time",
Â  Â  Â  Â  "Priority 3",
Â  Â  Â  Â  "Silver & Bronze",
Â  Â  Â  Â  "Measures the percentage of Priority 3 Incidents that were closed within 10 Business Days",
Â  Â  ],
Â  Â  [
Â  Â  Â  Â  "KPI-15",
Â  Â  Â  Â  "AMSÂ  ",
Â  Â  Â  Â  "Incident Closure Time",
Â  Â  Â  Â  "Priority 4",
Â  Â  Â  Â  "Platinum & Gold",
Â  Â  Â  Â  "Measures the percentage of Priority 4 Incidents that were closed within 15 Business Days",
Â  Â  ],
Â  Â  [
Â  Â  Â  Â  "KPI-16",
Â  Â  Â  Â  "AMSÂ  ",
Â  Â  Â  Â  "Incident Closure Time",
Â  Â  Â  Â  "Priority 4",
Â  Â  Â  Â  "Silver & Bronze",
Â  Â  Â  Â  "Measures the percentage of Priority 4 Incidents that were closed within 15 Business Days",
Â  Â  ],
Â  Â  [
Â  Â  Â  Â  "KPI-17",
Â  Â  Â  Â  "AMSÂ  ",
Â  Â  Â  Â  "Application Availability",
Â  Â  Â  Â  "NA",
Â  Â  Â  Â  "All",
Â  Â  Â  Â  "Measures the percentage of Clock Hours an application is available (excludes Maintenance time, downtime due to infra issues)",
Â  Â  ],
Â  Â  [
Â  Â  Â  Â  "KPI-18",
Â  Â  Â  Â  "AMSÂ  ",
Â  Â  Â  Â  "Problem Root Cause Identification Time",
Â  Â  Â  Â  "Priority 1",
Â  Â  Â  Â  "Platinum & Gold",
Â  Â  Â  Â  "Measures the percentage of Priority 1 Incidents for which Supplier provided a root cause analysis within 3 Calendar Days of resolution",
Â  Â  ],
Â  Â  [
Â  Â  Â  Â  "KPI-19",
Â  Â  Â  Â  "AMSÂ  ",
Â  Â  Â  Â  "Problem Root Cause Identification Time",
Â  Â  Â  Â  "Priority 2",
Â  Â  Â  Â  "Platinum & Gold",
Â  Â  Â  Â  "Measures the percentage of Priority 2 Incidents for which Supplier provided a root cause analysis within 5 Calendar Days of resolution",
Â  Â  ],
Â  Â  [
Â  Â  Â  Â  "KPI-20",
Â  Â  Â  Â  "AMSÂ  ",
Â  Â  Â  Â  "Problem Root Cause Identification Time",
Â  Â  Â  Â  "Priority 2",
Â  Â  Â  Â  "Silver",
Â  Â  Â  Â  "Measures the percentage of Priority 2 Incidents for which Supplier provided a root cause analysis within 5 Calendar Days of resolution",
Â  Â  ],
Â  Â  [
Â  Â  Â  Â  "KPI-21",
Â  Â  Â  Â  "AMSÂ  ",
Â  Â  Â  Â  "Emergency Change Effectiveness",
Â  Â  Â  Â  "NA",
Â  Â  Â  Â  "All",
Â  Â  Â  Â  "Measures the percentage of emergency Changes that are deployed successfully without rollback or creating any Incidents",
Â  Â  ],
Â  Â  [
Â  Â  Â  Â  "KPI-22",
Â  Â  Â  Â  "AMSÂ  ",
Â  Â  Â  Â  "Expedited Change Effectiveness",
Â  Â  Â  Â  "NA",
Â  Â  Â  Â  "All",
Â  Â  Â  Â  "Measures the percentage of expedited Changes that are deployed successfully without rollback or creating any Incidents",
Â  Â  ],
Â  Â  [
Â  Â  Â  Â  "KPI-23",
Â  Â  Â  Â  "AMSÂ  ",
Â  Â  Â  Â  "Change Success Effectiveness",
Â  Â  Â  Â  "All",
Â  Â  Â  Â  "All",
Â  Â  Â  Â  "Measures the percentage of Changes that are deployed successfully without rollback or creating any Incidents",
Â  Â  ],
Â  Â  [
Â  Â  Â  Â  "KPI-24",
Â  Â  Â  Â  "AMSÂ  ",
Â  Â  Â  Â  "Reports Accuracy",
Â  Â  Â  Â  "All",
Â  Â  Â  Â  "NA",
Â  Â  Â  Â  "Measures the number of reports as listed within Exhibit D-2 (Reports) submitted on-timeÂ  & with the correct information",
Â  Â  ],
Â  Â  [
Â  Â  Â  Â  "KPI-25",
Â  Â  Â  Â  "AMSÂ  ",
Â  Â  Â  Â  "On-time Resource Fulfillment",
Â  Â  Â  Â  "All",
Â  Â  Â  Â  "NA",
Â  Â  Â  Â  "Measures the percentage of resource requirements that were fulfilled on or before the agreed-upon deadline",
Â  Â  ],
Â  Â  [
Â  Â  Â  Â  "KPI-26",
Â  Â  Â  Â  "AMSÂ  ",
Â  Â  Â  Â  "Data Accuracy",
Â  Â  Â  Â  "All",
Â  Â  Â  Â  "All",
Â  Â  Â  Â  "Measures accuracy of Supplier's accuracy of data updates",
Â  Â  ],
Â  Â  [
Â  Â  Â  Â  "KPI-27",
Â  Â  Â  Â  "AMSÂ  ",
Â  Â  Â  Â  "Service Request Resolution Time",
Â  Â  Â  Â  "Priority 5 - Extended",
Â  Â  Â  Â  "Platinum & Gold",
Â  Â  Â  Â  "Measures the percentage of Priority 5 - Extended Service Requests where the final resolution was within 21 Calendar Days of assignment",
Â  Â  ],
Â  Â  [
Â  Â  Â  Â  "KPI-28",
Â  Â  Â  Â  "ADÂ  ",
Â  Â  Â  Â  "Cost Variance % - Overage",
Â  Â  Â  Â  "NA",
Â  Â  Â  Â  "NA",
Â  Â  Â  Â  "Measures the percentage of spend for Project Gates completed (as determined by the Cargill acceptance delivery of all pre-determined requirements) within Cargill accepted budgets.",
Â  Â  ],
Â  Â  [
Â  Â  Â  Â  "KPI-29",
Â  Â  Â  Â  "ADÂ  ",
Â  Â  Â  Â  "Effort Variance % - Overage",
Â  Â  Â  Â  "NA",
Â  Â  Â  Â  "NA",
Â  Â  Â  Â  "Measures the percentage of FTEs utilized for Project Gates completed (as determined by the Cargill acceptance delivery of all pre-determined requirements) within Cargill accepted estimates/budgets.",
Â  Â  ],
Â  Â  [
Â  Â  Â  Â  "KPI-30",
Â  Â  Â  Â  "ADÂ  ",
Â  Â  Â  Â  "% Projects On Time",
Â  Â  Â  Â  "NA",
Â  Â  Â  Â  "NA",
Â  Â  Â  Â  "Measures the percentage of Project Gates timely completed",
Â  Â  ],
Â  Â  [
Â  Â  Â  Â  "KPI-31",
Â  Â  Â  Â  "ADÂ  ",
Â  Â  Â  Â  "Post Production Defects - Critical & High",
Â  Â  Â  Â  "NA",
Â  Â  Â  Â  "NA",
Â  Â  Â  Â  "Percentage of post project go-live Defects (Number of Critical & High Defects detected during Hypercare)",
Â  Â  ],
Â  Â  [
Â  Â  Â  Â  "KPI-32",
Â  Â  Â  Â  "ADÂ  ",
Â  Â  Â  Â  "UAT Defects - C & H",
Â  Â  Â  Â  "NA",
Â  Â  Â  Â  "NA",
Â  Â  Â  Â  "Measures the quality of the systems testing based on the identification of Defects during User Acceptance Testing. Defects are defined as Incidents / Problems that would be categorized as CriticalÂ  & High.",
Â  Â  ],
Â  Â  [
Â  Â  Â  Â  "KPI-33",
Â  Â  Â  Â  "ADÂ  ",
Â  Â  Â  Â  "Defect Removal Efficiency",
Â  Â  Â  Â  "NA",
Â  Â  Â  Â  "NA",
Â  Â  Â  Â  "Number of Defects responded toÂ  & fixed",
Â  Â  ],
Â  Â  [
Â  Â  Â  Â  "KPI-34",
Â  Â  Â  Â  "ADÂ  ",
Â  Â  Â  Â  "Defect Density",
Â  Â  Â  Â  "NA",
Â  Â  Â  Â  "NA",
Â  Â  Â  Â  "Measures the density of Defects compared to size of code",
Â  Â  ],
Â  Â  [
Â  Â  Â  Â  "KPI-35",
Â  Â  Â  Â  "ADÂ  ",
Â  Â  Â  Â  "On-time resource fulfillment",
Â  Â  Â  Â  "NA",
Â  Â  Â  Â  "NA",
Â  Â  Â  Â  "Measures the percentage of resource requests that were fulfilled before the agreed-upon deadline.",
Â  Â  ],
];

>>>lib/sla-data.ts
export const slaData = [
Â  Â  [
Â  Â  Â  Â  "SL-1",
Â  Â  Â  Â  "AMSÂ  ",
Â  Â  Â  Â  "Incident Resolution Time",
Â  Â  Â  Â  "Priority 1",
Â  Â  Â  Â  "Platinum & Gold",
Â  Â  Â  Â  "Measures the percentage of Priority 1 Incidents where the final resolution was within 4 Clock Hours of assignment",
Â  Â  ],
Â  Â  [
Â  Â  Â  Â  "SL-2",
Â  Â  Â  Â  "AMSÂ  ",
Â  Â  Â  Â  "Incident Resolution Time",
Â  Â  Â  Â  "Priority 1",
Â  Â  Â  Â  "Silver",
Â  Â  Â  Â  "Measures the percentage of Priority 1 Incidents where the final resolution was within 4 Clock Hours of assignment",
Â  Â  ],
Â  Â  [
Â  Â  Â  Â  "SL-3",
Â  Â  Â  Â  "AMSÂ  ",
Â  Â  Â  Â  "Incident Resolution Time",
Â  Â  Â  Â  "Priority 2",
Â  Â  Â  Â  "Platinum & Gold",
Â  Â  Â  Â  "Measures the percentage of Priority 2 Incidents where the final resolution was within 8 Clock Hours of assignment",
Â  Â  ],
Â  Â  [
Â  Â  Â  Â  "SL-4",
Â  Â  Â  Â  "AMSÂ  ",
Â  Â  Â  Â  "Incident Resolution Time",
Â  Â  Â  Â  "Priority 2",
Â  Â  Â  Â  "Silver",
Â  Â  Â  Â  "Measures the percentage of Priority 2 Incidents where the final resolution was within 8 Clock Hours of assignment",
Â  Â  ],
Â  Â  [
Â  Â  Â  Â  "SL-5",
Â  Â  Â  Â  "AMSÂ  ",
Â  Â  Â  Â  "Incident Resolution Time",
Â  Â  Â  Â  "Priority 3",
Â  Â  Â  Â  "Platinum & Gold",
Â  Â  Â  Â  "Measures the percentage of Priority 3 Incidents where the final resolution was within 3 Business Days of assignment",
Â  Â  ],
Â  Â  [
Â  Â  Â  Â  "SL-6",
Â  Â  Â  Â  "AMSÂ  ",
Â  Â  Â  Â  "Incident Resolution Time",
Â  Â  Â  Â  "Priority 3",
Â  Â  Â  Â  "Silver & Bronze",
Â  Â  Â  Â  "Measures the percentage of Priority 3 Incidents where the final resolution was within 3 Business Days of assignment",
Â  Â  ],
Â  Â  [
Â  Â  Â  Â  "SL-7",
Â  Â  Â  Â  "AMSÂ  ",
Â  Â  Â  Â  "Incident Resolution Time",
Â  Â  Â  Â  "Priority 4",
Â  Â  Â  Â  "Platinum & Gold",
Â  Â  Â  Â  "Measures the percentage of Priority 4 Incidents where the final resolution was within 5 Business Days of assignment",
Â  Â  ],
Â  Â  [
Â  Â  Â  Â  "SL-8",
Â  Â  Â  Â  "AMSÂ  ",
Â  Â  Â  Â  "Incident Resolution Time",
Â  Â  Â  Â  "Priority 4",
Â  Â  Â  Â  "Silver & Bronze",
Â  Â  Â  Â  "Measures the percentage of Priority 4 Incidents where the final resolution was within 5 Business Days of assignment",
Â  Â  ],
Â  Â  [
Â  Â  Â  Â  "SL-9",
Â  Â  Â  Â  "AMSÂ  ",
Â  Â  Â  Â  "Incident Reopens %",
Â  Â  Â  Â  "Priority 1Â  & 2",
Â  Â  Â  Â  "Platinum, Gold, Silver",
Â  Â  Â  Â  "Measures the percentage of Priority 1Â  & 2 Incidents that were reopened post resolution",
Â  Â  ],
Â  Â  [
Â  Â  Â  Â  "SL-10",
Â  Â  Â  Â  "AMSÂ  ",
Â  Â  Â  Â  "Incident Reopens %",
Â  Â  Â  Â  "Priority 3Â  & 4",
Â  Â  Â  Â  "Platinum, Gold, Silver, Bronze",
Â  Â  Â  Â  "Measures the percentage of Priority 3Â  & 4 Incidents that were reopened post resolution",
Â  Â  ],
Â  Â  [
Â  Â  Â  Â  "SL-11",
Â  Â  Â  Â  "AMSÂ  ",
Â  Â  Â  Â  "End User CSAT",
Â  Â  Â  Â  "All",
Â  Â  Â  Â  "All",
Â  Â  Â  Â  "Measures business satisfaction with AMS",
Â  Â  ],
Â  Â  [
Â  Â  Â  Â  "SL-12",
Â  Â  Â  Â  "AMSÂ  ",
Â  Â  Â  Â  "Service Request Resolution Time",
Â  Â  Â  Â  "Priority 1",
Â  Â  Â  Â  "Platinum & Gold",
Â  Â  Â  Â  "Measures the percentage of Priority 1 Service Requests that were resolved within 6 Clock Hours",
Â  Â  ],
Â  Â  [
Â  Â  Â  Â  "SL-13",
Â  Â  Â  Â  "AMSÂ  ",
Â  Â  Â  Â  "Service Request Resolution Time",
Â  Â  Â  Â  "Priority 1",
Â  Â  Â  Â  "Silver",
Â  Â  Â  Â  "Measures the percentage of Priority 1 Service Requests that were resolved within 6 Clock Hours",
Â  Â  ],
Â  Â  [
Â  Â  Â  Â  "SL-14",
Â  Â  Â  Â  "AMSÂ  ",
Â  Â  Â  Â  "Service Request Resolution Time",
Â  Â  Â  Â  "Priority 2",
Â  Â  Â  Â  "Platinum & Gold",
Â  Â  Â  Â  "Measures the percentage of Priority 2 Service Requests that were resolved within 4 Calendar Days",
Â  Â  ],
Â  Â  [
Â  Â  Â  Â  "SL-15",
Â  Â  Â  Â  "AMSÂ  ",
Â  Â  Â  Â  "Service Request Resolution Time",
Â  Â  Â  Â  "Priority 2",
Â  Â  Â  Â  "Silver",
Â  Â  Â  Â  "Measures the percentage of Priority 2 Service Requests that were resolved within 4 Calendar Days",
Â  Â  ],
Â  Â  [
Â  Â  Â  Â  "SL-16",
Â  Â  Â  Â  "AMSÂ  ",
Â  Â  Â  Â  "Service Request Resolution Time",
Â  Â  Â  Â  "Priority 3Â  & 4",
Â  Â  Â  Â  "Platinum & Gold",
Â  Â  Â  Â  "Measures the percentage of Priority 3Â  & 4 Service Requests that were resolved within 7 Calendar Days",
Â  Â  ],
Â  Â  [
Â  Â  Â  Â  "SL-17",
Â  Â  Â  Â  "AMSÂ  ",
Â  Â  Â  Â  "Service Request Resolution Time",
Â  Â  Â  Â  "Priority 4",
Â  Â  Â  Â  "Platinum & Gold",
Â  Â  Â  Â  "Measures the percentage of Priority 4 Service Requests that were resolved within 14 Calendar Days",
Â  Â  ],
Â  Â  [
Â  Â  Â  Â  "SL-18",
Â  Â  Â  Â  "AMSÂ  ",
Â  Â  Â  Â  "Service Request Resolution Time",
Â  Â  Â  Â  "Priority 3Â  & 4",
Â  Â  Â  Â  "Silver & Bronze",
Â  Â  Â  Â  "Measures the percentage of Priority 3Â  & 4 Service Requests that were resolved within 7 Calendar Days",
Â  Â  ],
Â  Â  [
Â  Â  Â  Â  "SL-19",
Â  Â  Â  Â  "AMSÂ  ",
Â  Â  Â  Â  "Service Request Resolution Time",
Â  Â  Â  Â  "Priority 4",
Â  Â  Â  Â  "Silver & Bronze",
Â  Â  Â  Â  "Measures the percentage of Priority 4 Service Requests that were resolved within 14 Calendar Days",
Â  Â  ],
Â  Â  [
Â  Â  Â  Â  "SL-20",
Â  Â  Â  Â  "AMSÂ  ",
Â  Â  Â  Â  "Change Success",
Â  Â  Â  Â  "All",
Â  Â  Â  Â  "All",
Â  Â  Â  Â  "Measures the percentage of changes that are deployed successfully without rollback or creating any incidents",
Â  Â  ],
];

>>>lib/utils.ts
import { clsx, type ClassValue } from "clsx"
import { twMerge } from "tailwind-merge"

export function cn(...inputs: ClassValue[]) {
Â  return twMerge(clsx(inputs))
}

>>>scripts/createExcel.ts
import ExcelJS from 'exceljs';

// This function creates Excel files from the CSV data
export async function createExcelFiles() {
Â  Â  try {
Â  Â  Â  Â  // Enterprise data
Â  Â  Â  Â  const enterpriseData = [
Â  Â  Â  Â  Â  Â  ['Enterprise ID', 'Enterprise Name', 'Icon', 'Color', 'Apps', 'Value Savings', 'Vulnerabilities', 'Innovations', 'P1'],
Â  Â  Â  Â  Â  Â  ['ag-trading', 'Ag & Trading Enterprise', 'TrendingUp', 'from-green-500 to-emerald-600', 145, '$234K', 250, '50+', 3],
Â  Â  Â  Â  Â  Â  ['food', 'Food Enterprise', 'Utensils', 'from-orange-500 to-red-600', 226, '$180K', 120, '30+', 2],
Â  Â  Â  Â  Â  Â  ['spec-portfolio', 'Specialized Portfolio', 'Heart', 'from-purple-500 to-pink-600', 230, '$150K', 95, '25+', 4],
Â  Â  Â  Â  Â  Â  ['core-capabs', 'Core Capability', 'Building2', 'from-blue-500 to-indigo-600', 383, '$120K', 80, '20+', 0]
Â  Â  Â  Â  ];

Â  Â  Â  Â  // Business units data
Â  Â  Â  Â  const businessUnitsData = [
Â  Â  Â  Â  Â  Â  ['Enterprise ID', 'Business Unit Name', 'Apps', 'Value Savings', 'Vulnerabilities', 'Innovations', 'P1'],
Â  Â  Â  Â  Â  Â  ['ag-trading', 'Ag & Trading Enterprise', 17, '$27K', 28, 6, 1],
Â  Â  Â  Â  Â  Â  ['ag-trading', 'Ag & Trading Asia Pacific', 16, '$26K', 28, 6, 1],
Â  Â  Â  Â  Â  Â  ['ag-trading', 'Ag & Trading Europe Middle East', 16, '$26K', 28, 5, 1],
Â  Â  Â  Â  Â  Â  ['ag-trading', 'Ag & Trading North America', 16, '$26K', 28, 5, 0],
Â  Â  Â  Â  Â  Â  ['ag-trading', 'Ag & Trading Latin America', 16, '$26K', 28, 5, 0],
Â  Â  Â  Â  Â  Â  ['ag-trading', 'Ocean Transportation', 16, '$26K', 27, 5, 0],
Â  Â  Â  Â  Â  Â  ['ag-trading', 'World Trading', 16, '$26K', 27, 5, 0],
Â  Â  Â  Â  Â  Â  ['ag-trading', 'Cargill Risk Management', 16, '$26K', 27, 5, 0],
Â  Â  Â  Â  Â  Â  ['ag-trading', 'Metals', 16, '$25K', 27, 5, 0],
Â  Â  Â  Â  Â  Â  ['food', 'Commercial Excellence', 113, '$90K', 60, 15, 1],
Â  Â  Â  Â  Â  Â  ['food', 'Food Enterprise', 113, '$90K', 60, 15, 1],
Â  Â  Â  Â  Â  Â  ['spec-portfolio', 'Animal Nutrition & Health', 77, '$50K', 32, 9, 2],
Â  Â  Â  Â  Â  Â  ['spec-portfolio', 'Cargill Bioindustrial', 77, '$50K', 32, 8, 1],
Â  Â  Â  Â  Â  Â  ['spec-portfolio', 'Deicing Solutions', 76, '$50K', 31, 8, 1],
Â  Â  Â  Â  Â  Â  ['core-capabs', 'Trade & Capital Markets', 192, '$60K', 40, 10, 0],
Â  Â  Â  Â  Â  Â  ['core-capabs', 'Trading & Risk Management', 191, '$60K', 40, 10, 0]
Â  Â  Â  Â  ];

Â  Â  Â  Â  // Create workbook
Â  Â  Â  Â  const workbook = new ExcelJS.Workbook();

Â  Â  Â  Â  // Create worksheets
Â  Â  Â  Â  const enterpriseWorksheet = workbook.addWorksheet('Enterprises');
Â  Â  Â  Â  const businessUnitsWorksheet = workbook.addWorksheet('BusinessUnits');

Â  Â  Â  Â  // Add data to worksheets
Â  Â  Â  Â  enterpriseWorksheet.addRows(enterpriseData);
Â  Â  Â  Â  businessUnitsWorksheet.addRows(businessUnitsData);

Â  Â  Â  Â  // Write to file (updated to use correct path for current workspace)
Â  Â  Â  Â  await workbook.xlsx.writeFile('./public/data/enterprise-metrics.xlsx');

Â  Â  Â  Â  console.log('Excel file created successfully!');
Â  Â  Â  Â  return true;
Â  Â  } catch (error) {
Â  Â  Â  Â  console.error('Error creating Excel file:', error);
Â  Â  Â  Â  return false;
Â  Â  }
}

>>>scripts/generateCsvFromExcel.ts
import * as ExcelJS from 'exceljs';
import * as fs from 'fs';
import * as path from 'path';

export async function generateCsvFromExcel(): Promise<void> {
Â  Â  try {
Â  Â  Â  Â  console.log('Starting CSV generation from Excel file...');

Â  Â  Â  Â  // Path to the Excel file
Â  Â  Â  Â  const excelPath = path.join(process.cwd(), 'public', 'data', 'enterprise-metrics.xlsx');
Â  Â  Â  Â  const csvDir = path.join(process.cwd(), 'public', 'data');

Â  Â  Â  Â  console.log('Reading Excel file:', excelPath);

Â  Â  Â  Â  // Create workbook and read the Excel file
Â  Â  Â  Â  const workbook = new ExcelJS.Workbook();
Â  Â  Â  Â  await workbook.xlsx.readFile(excelPath);

Â  Â  Â  Â  console.log('Available worksheets:');
Â  Â  Â  Â  workbook.eachSheet((worksheet, sheetId) => {
Â  Â  Â  Â  Â  Â  console.log(`Â  ${sheetId}: ${worksheet.name}`);
Â  Â  Â  Â  });

Â  Â  Â  Â  // Process Enterprises data
Â  Â  Â  Â  console.log('\nProcessing Enterprises worksheet...');
Â  Â  Â  Â  const enterpriseWorksheet = workbook.getWorksheet('Enterprises');
Â  Â  Â  Â  if (!enterpriseWorksheet) {
Â  Â  Â  Â  Â  Â  throw new Error('Enterprises worksheet not found');
Â  Â  Â  Â  }

Â  Â  Â  Â  // Generate enterprises.csv
Â  Â  Â  Â  const enterprisesCsvData: string[] = [];
Â  Â  Â  Â  const enterpriseHeaders: string[] = [];

Â  Â  Â  Â  // Get headers from first row
Â  Â  Â  Â  const enterpriseHeaderRow = enterpriseWorksheet.getRow(1);
Â  Â  Â  Â  enterpriseHeaderRow.eachCell((cell) => {
Â  Â  Â  Â  Â  Â  enterpriseHeaders.push(cell.value?.toString() || '');
Â  Â  Â  Â  });
Â  Â  Â  Â  enterprisesCsvData.push(enterpriseHeaders.join(','));

Â  Â  Â  Â  // Get data rows
Â  Â  Â  Â  for (let rowNumber = 2; rowNumber <= enterpriseWorksheet.rowCount; rowNumber++) {
Â  Â  Â  Â  Â  Â  const row = enterpriseWorksheet.getRow(rowNumber);
Â  Â  Â  Â  Â  Â  if (row.hasValues) {
Â  Â  Â  Â  Â  Â  Â  Â  const rowData: string[] = [];
Â  Â  Â  Â  Â  Â  Â  Â  for (let col = 1; col <= enterpriseHeaders.length; col++) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const cellValue = row.getCell(col).value;
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  // Handle formulas by getting the result
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  let value = '';
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  if (cellValue && typeof cellValue === 'object' && 'result' in cellValue) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  value = cellValue.result?.toString() || '';
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  } else {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  value = cellValue?.toString() || '';
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  rowData.push(value);
Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  Â  Â  enterprisesCsvData.push(rowData.join(','));
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  }

Â  Â  Â  Â  // Write enterprises.csv
Â  Â  Â  Â  const enterprisesCsvPath = path.join(csvDir, 'enterprises.csv');
Â  Â  Â  Â  fs.writeFileSync(enterprisesCsvPath, enterprisesCsvData.join('\n'));
Â  Â  Â  Â  console.log(`âœ“ Generated ${enterprisesCsvPath}`);
Â  Â  Â  Â  console.log(`Â  Rows: ${enterprisesCsvData.length - 1} (excluding header)`);

Â  Â  Â  Â  // Process Business Units data
Â  Â  Â  Â  console.log('\nProcessing BusinessUnits worksheet...');
Â  Â  Â  Â  const businessUnitsWorksheet = workbook.getWorksheet('BusinessUnits');
Â  Â  Â  Â  if (!businessUnitsWorksheet) {
Â  Â  Â  Â  Â  Â  throw new Error('BusinessUnits worksheet not found');
Â  Â  Â  Â  }

Â  Â  Â  Â  // Generate business-units.csv
Â  Â  Â  Â  const businessUnitsCsvData: string[] = [];
Â  Â  Â  Â  const businessUnitsHeaders: string[] = [];

Â  Â  Â  Â  // Get headers from first row
Â  Â  Â  Â  const businessUnitsHeaderRow = businessUnitsWorksheet.getRow(1);
Â  Â  Â  Â  businessUnitsHeaderRow.eachCell((cell) => {
Â  Â  Â  Â  Â  Â  businessUnitsHeaders.push(cell.value?.toString() || '');
Â  Â  Â  Â  });
Â  Â  Â  Â  businessUnitsCsvData.push(businessUnitsHeaders.join(','));

Â  Â  Â  Â  // Get data rows
Â  Â  Â  Â  for (let rowNumber = 2; rowNumber <= businessUnitsWorksheet.rowCount; rowNumber++) {
Â  Â  Â  Â  Â  Â  const row = businessUnitsWorksheet.getRow(rowNumber);
Â  Â  Â  Â  Â  Â  if (row.hasValues) {
Â  Â  Â  Â  Â  Â  Â  Â  const rowData: string[] = [];
Â  Â  Â  Â  Â  Â  Â  Â  for (let col = 1; col <= businessUnitsHeaders.length; col++) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const cellValue = row.getCell(col).value;
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  // Handle formulas by getting the result
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  let value = '';
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  if (cellValue && typeof cellValue === 'object' && 'result' in cellValue) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  value = cellValue.result?.toString() || '';
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  } else {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  value = cellValue?.toString() || '';
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  rowData.push(value);
Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  Â  Â  businessUnitsCsvData.push(rowData.join(','));
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  }

Â  Â  Â  Â  // Write business-units.csv
Â  Â  Â  Â  const businessUnitsCsvPath = path.join(csvDir, 'business-units.csv');
Â  Â  Â  Â  fs.writeFileSync(businessUnitsCsvPath, businessUnitsCsvData.join('\n'));
Â  Â  Â  Â  console.log(`âœ“ Generated ${businessUnitsCsvPath}`);
Â  Â  Â  Â  console.log(`Â  Rows: ${businessUnitsCsvData.length - 1} (excluding header)`);

Â  Â  Â  Â  console.log('\nâœ… CSV generation completed successfully!');

Â  Â  Â  Â  // Verify the generated files
Â  Â  Â  Â  console.log('\nVerifying generated files:');

Â  Â  Â  Â  // Check enterprises.csv
Â  Â  Â  Â  const enterprisesContent = fs.readFileSync(enterprisesCsvPath, 'utf8');
Â  Â  Â  Â  const enterprisesLines = enterprisesContent.split('\n').filter(line => line.trim());
Â  Â  Â  Â  console.log(`Â  enterprises.csv: ${enterprisesLines.length} lines`);
Â  Â  Â  Â  console.log(`Â  Â  Header: ${enterprisesLines[0]}`);
Â  Â  Â  Â  if (enterprisesLines.length > 1) {
Â  Â  Â  Â  Â  Â  console.log(`Â  Â  Sample row: ${enterprisesLines[1]}`);
Â  Â  Â  Â  }

Â  Â  Â  Â  // Check business-units.csv
Â  Â  Â  Â  const businessUnitsContent = fs.readFileSync(businessUnitsCsvPath, 'utf8');
Â  Â  Â  Â  const businessUnitsLines = businessUnitsContent.split('\n').filter(line => line.trim());
Â  Â  Â  Â  console.log(`Â  business-units.csv: ${businessUnitsLines.length} lines`);
Â  Â  Â  Â  console.log(`Â  Â  Header: ${businessUnitsLines[0]}`);
Â  Â  Â  Â  if (businessUnitsLines.length > 1) {
Â  Â  Â  Â  Â  Â  console.log(`Â  Â  Sample row: ${businessUnitsLines[1]}`);
Â  Â  Â  Â  }

Â  Â  } catch (error) {
Â  Â  Â  Â  const errorMessage = error instanceof Error ? error.message : String(error);
Â  Â  Â  Â  console.error('âŒ Error generating CSV files:', errorMessage);
Â  Â  Â  Â  if (error instanceof Error) {
Â  Â  Â  Â  Â  Â  console.error(error.stack);
Â  Â  Â  Â  }
Â  Â  Â  Â  process.exit(1);
Â  Â  }
}

// Run the script if called directly
if (require.main === module) {
Â  Â  generateCsvFromExcel();
}

