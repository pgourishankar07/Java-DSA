>>>app/globals.css
@import "tailwindcss";
@import "tw-animate-css";

@custom-variant dark (&:is(.dark *));

@theme inline {
Â  --color-background: var(--background);
Â  --color-foreground: var(--foreground);
Â  --font-sans: var(--font-inter);
Â  --font-serif: var(--font-playfair);
Â  --color-sidebar-ring: var(--sidebar-ring);
Â  --color-sidebar-border: var(--sidebar-border);
Â  --color-sidebar-accent-foreground: var(--sidebar-accent-foreground);
Â  --color-sidebar-accent: var(--sidebar-accent);
Â  --color-sidebar-primary-foreground: var(--sidebar-primary-foreground);
Â  --color-sidebar-primary: var(--sidebar-primary);
Â  --color-sidebar-foreground: var(--sidebar-foreground);
Â  --color-sidebar: var(--sidebar);
Â  --color-chart-5: var(--chart-5);
Â  --color-chart-4: var(--chart-4);
Â  --color-chart-3: var(--chart-3);
Â  --color-chart-2: var(--chart-2);
Â  --color-chart-1: var(--chart-1);
Â  --color-ring: var(--ring);
Â  --color-input: var(--input);
Â  --color-border: var(--border);
Â  --color-destructive: var(--destructive);
Â  --color-accent-foreground: var(--accent-foreground);
Â  --color-accent: var(--accent);
Â  --color-muted-foreground: var(--muted-foreground);
Â  --color-muted: var(--muted);
Â  --color-secondary-foreground: var(--secondary-foreground);
Â  --color-secondary: var(--secondary);
Â  --color-primary-foreground: var(--primary-foreground);
Â  --color-primary: var(--primary);
Â  --color-popover-foreground: var(--popover-foreground);
Â  --color-popover: var(--popover);
Â  --color-card-foreground: var(--card-foreground);
Â  --color-card: var(--card);
Â  --radius-sm: calc(var(--radius) - 4px);
Â  --radius-md: calc(var(--radius) - 2px);
Â  --radius-lg: var(--radius);
Â  --radius-xl: calc(var(--radius) + 4px);
}

:root {
Â  --radius: 0.625rem;
Â  --background: oklch(1 0 0);
Â  --foreground: oklch(0.1371 0.036 258.5);
Â  --card: oklch(1 0 0);
Â  --card-foreground: oklch(0.145 0 0);
Â  --popover: oklch(1 0 0);
Â  --popover-foreground: oklch(0.145 0 0);
Â  --primary: oklch(48.775% 0.14108 147.717);
Â  --primary-foreground: oklch(0.985 0 0);
Â  --secondary: oklch(0.9676 0.007 247.9);
Â  --secondary-foreground: oklch(0.205 0 0);
Â  --muted: oklch(0.97 0 0);
Â  --muted-foreground: oklch(0.5547 0.0407 257.4);
Â  --accent: oklch(0.97 0 0);
Â  --accent-foreground: oklch(0.205 0 0);
Â  --destructive: oklch(0.577 0.245 27.325);
Â  --border: oklch(0.929 0.0126 255.53);
Â  --input: oklch(0.922 0 0);
Â  --ring: oklch(0.708 0 0);
Â  --chart-1: oklch(0.646 0.222 41.116);
Â  --chart-2: oklch(0.6 0.118 184.704);
Â  --chart-3: oklch(0.398 0.07 227.392);
Â  --chart-4: oklch(0.828 0.189 84.429);
Â  --chart-5: oklch(0.769 0.188 70.08);
Â  --sidebar: oklch(0.985 0 0);
Â  --sidebar-foreground: oklch(0.145 0 0);
Â  --sidebar-primary: oklch(0.205 0 0);
Â  --sidebar-primary-foreground: oklch(0.985 0 0);
Â  --sidebar-accent: oklch(0.97 0 0);
Â  --sidebar-accent-foreground: oklch(0.205 0 0);
Â  --sidebar-border: oklch(0.922 0 0);
Â  --sidebar-ring: oklch(0.708 0 0);
}

.dark {
Â  --background: oklch(0.1371 0.036 258.5);
Â  --foreground: oklch(0.9838 0.0035 247.86);
Â  --card: oklch(0.1371 0.036 258.5);
Â  --card-foreground: oklch(0.985 0 0);
Â  --popover: oklch(0.205 0 0);
Â  --popover-foreground: oklch(0.985 0 0);
Â  --primary: oklch(51.904% 0.141 150.103);
Â  --primary-foreground: oklch(0.205 0 0);
Â  --secondary: oklch(0.28 0.0369 260);
Â  --secondary-foreground: oklch(0.985 0 0);
Â  --muted: oklch(0.269 0 0);
Â  --muted-foreground: oklch(0.7107 0.0351 256.8);
Â  --accent: oklch(0.269 0 0);
Â  --accent-foreground: oklch(0.985 0 0);
Â  --destructive: oklch(0.704 0.191 22.216);
Â  --border: oklch(0.28 0.0369 260);
Â  --input: oklch(1 0 0 / 15%);
Â  --ring: oklch(0.556 0 0);
Â  --chart-1: oklch(0.488 0.243 264.376);
Â  --chart-2: oklch(0.696 0.17 162.48);
Â  --chart-3: oklch(0.769 0.188 70.08);
Â  --chart-4: oklch(0.627 0.265 303.9);
Â  --chart-5: oklch(0.645 0.246 16.439);
Â  --sidebar: oklch(0.205 0 0);
Â  --sidebar-foreground: oklch(0.985 0 0);
Â  --sidebar-primary: oklch(49.868% 0.1521 145.706);
Â  --sidebar-primary-foreground: oklch(0.985 0 0);
Â  --sidebar-accent: oklch(0.269 0 0);
Â  --sidebar-accent-foreground: oklch(0.985 0 0);
Â  --sidebar-border: oklch(1 0 0 / 10%);
Â  --sidebar-ring: oklch(0.556 0 0);
}

@layer base {
Â  * {
Â  Â  @apply border-border outline-ring/50;
Â  }
Â  body {
Â  Â  @apply bg-background text-foreground;
Â  }
}

/* Custom Scrollbar */

::-webkit-scrollbar {
Â  width: 8px;
}

::-webkit-scrollbar-track {
Â  background: var(--secondary);
}

::-webkit-scrollbar-thumb {
Â  background: var(--primary);
Â  border-radius: 4px;
}

::-webkit-scrollbar-thumb:hover {
Â  background: var(--primary) / 0.8;
}

/* Custom scrollbar for business units */
.custom-scrollbar::-webkit-scrollbar {
Â width: 6px;
}


.custom-scrollbar::-webkit-scrollbar-track {
Â background: rgba(0, 0, 0, 0.1);
Â border-radius: 3px;
}


.custom-scrollbar::-webkit-scrollbar-thumb {
Â background: rgba(59, 130, 246, 0.5);
Â border-radius: 3px;
}


.custom-scrollbar::-webkit-scrollbar-thumb:hover {
Â background: rgba(59, 130, 246, 0.7);
}

>>>app/layout.tsx
import type { Metadata } from "next";
import localFont from "next/font/local";
import "./globals.css";
import { ThemeProvider } from "@/components/ui/ThemeProvider";
import Navigation from "@/components/Navigation";
import Footer from "@/components/Footer";

// Configure the Inter font using localFont with the correct file names
const inter = localFont({
Â  src: [
Â  Â  {
Â  Â  Â  path: "../public/fonts/Inter_18pt-Regular.ttf", // Corrected path
Â  Â  Â  weight: "400",
Â  Â  Â  style: "normal",
Â  Â  },
Â  Â  {
Â  Â  Â  path: "../public/fonts/Inter_18pt-SemiBold.ttf", // Corrected path
Â  Â  Â  weight: "600",
Â  Â  Â  style: "normal",
Â  Â  },
Â  Â  // Add other Inter font weights/styles you need
Â  ],
Â  variable: "--font-inter",
});

// Configure the Playfair Display font using localFont with the correct file names
const playfair = localFont({
Â  src: [
Â  Â  {
Â  Â  Â  path: "../public/fonts/PlayfairDisplay-Regular.ttf", // Corrected path
Â  Â  Â  weight: "400",
Â  Â  Â  style: "normal",
Â  Â  },
Â  Â  {
Â  Â  Â  path: "../public/fonts/PlayfairDisplay-Bold.ttf", // Corrected path
Â  Â  Â  weight: "700",
Â  Â  Â  style: "normal",
Â  Â  },
Â  Â  // Add other Playfair Display font weights/styles you need
Â  ],
Â  variable: "--font-playfair",
});

export const metadata: Metadata = {
Â  title: "Cargill | Dashboard",
Â  description: "Creating a more food secure world",
};

export default function RootLayout({
Â  children,
}: Readonly<{
Â  children: React.ReactNode;
}>) {
Â  return (
Â  Â  <html lang="en" suppressHydrationWarning>
Â  Â  Â  <body className={`${inter.variable} ${playfair.variable} antialiased`}>
Â  Â  Â  Â  <ThemeProvider
Â  Â  Â  Â  Â  attribute="class"
Â  Â  Â  Â  Â  defaultTheme="system"
Â  Â  Â  Â  Â  enableSystem
Â  Â  Â  Â  Â  disableTransitionOnChange
Â  Â  Â  Â  >
Â  Â  Â  Â  Â  <Navigation />
Â  Â  Â  Â  Â  {children}
Â  Â  Â  Â  Â  <Footer />
Â  Â  Â  Â  </ThemeProvider>
Â  Â  Â  </body>
Â  Â  </html>
Â  );
}

>>>app/page.tsx
import AboutEngagement from "@/components/about-engagement";
import CategoriesSection from "@/components/CategoriesSection";
import HeroSection from "@/components/HeroSection";
import QuotesSection from "@/components/QuotesSection";
import SidebarNavigation from "@/components/ui/SidebarNavigation";
import { WorldMapDemo } from "@/components/ui/world-map-demo";

export default function Home() {
Â  return (
Â  Â  <div className="min-h-screen bg-background">
Â  Â  Â  <main>
Â  Â  Â  Â  <HeroSection />
Â  Â  Â  Â  <div id="about-engagement">
Â  Â  Â  Â  Â  <AboutEngagement />
Â  Â  Â  Â  </div>
Â  Â  Â  Â  <div id="categories-section">
Â  Â  Â  Â  Â  <CategoriesSection />
Â  Â  Â  Â  </div>
Â  Â  Â  Â  <div id="world-map">
Â  Â  Â  Â  Â  <WorldMapDemo />
Â  Â  Â  Â  </div>
Â  Â  Â  Â  <div id="quotes-section">
Â  Â  Â  Â  Â  <QuotesSection />
Â  Â  Â  Â  </div>
Â  Â  Â  </main>
Â  Â  Â  <SidebarNavigation />
Â  Â  </div>
Â  );
}

>>>app/about/page.tsx
"use client";
import { motion } from "motion/react";
import { Leaf, Users, Globe, Award, ArrowRight } from "lucide-react";

export default function AboutPage() {
Â  return (
Â  Â  <div className="min-h-screen bg-background">
Â  Â  Â  {/* Hero Section */}
Â  Â  Â  <section className="relative py-20 lg:py-32 overflow-hidden">
Â  Â  Â  Â  <div className="absolute inset-0 bg-gradient-to-br from-green-50 to-blue-50 dark:from-green-950/20 dark:to-blue-950/20"></div>
Â  Â  Â  Â  <div className="relative max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
Â  Â  Â  Â  Â  <div className="grid grid-cols-1 lg:grid-cols-2 gap-12 items-center">
Â  Â  Â  Â  Â  Â  <motion.div
Â  Â  Â  Â  Â  Â  Â  initial={{ opacity: 0, x: -50 }}
Â  Â  Â  Â  Â  Â  Â  animate={{ opacity: 1, x: 0 }}
Â  Â  Â  Â  Â  Â  Â  transition={{ duration: 0.8 }}
Â  Â  Â  Â  Â  Â  >
Â  Â  Â  Â  Â  Â  Â  <h1 className="text-4xl lg:text-6xl font-bold text-gray-900 dark:text-white mb-6">
Â  Â  Â  Â  Â  Â  Â  Â  About{" "}
Â  Â  Â  Â  Â  Â  Â  Â  <span className="text-transparent bg-clip-text bg-gradient-to-r from-green-600 to-blue-600">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Cargill
Â  Â  Â  Â  Â  Â  Â  Â  </span>
Â  Â  Â  Â  Â  Â  Â  </h1>
Â  Â  Â  Â  Â  Â  Â  <p className="text-xl text-gray-600 dark:text-gray-300 mb-8 leading-relaxed">
Â  Â  Â  Â  Â  Â  Â  Â  We are a family company providing food, ingredients,
Â  Â  Â  Â  Â  Â  Â  Â  agricultural solutions and industrial products to nourish the
Â  Â  Â  Â  Â  Â  Â  Â  world in a safe, responsible and sustainable way.
Â  Â  Â  Â  Â  Â  Â  </p>
Â  Â  Â  Â  Â  Â  Â  <motion.div
Â  Â  Â  Â  Â  Â  Â  Â  initial={{ opacity: 0, y: 20 }}
Â  Â  Â  Â  Â  Â  Â  Â  animate={{ opacity: 1, y: 0 }}
Â  Â  Â  Â  Â  Â  Â  Â  transition={{ duration: 0.8, delay: 0.2 }}
Â  Â  Â  Â  Â  Â  Â  Â  className="flex items-center text-green-600 dark:text-green-400 font-semibold"
Â  Â  Â  Â  Â  Â  Â  >
Â  Â  Â  Â  Â  Â  Â  Â  <span className="mr-2">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Bringing access to life&apos;s essentials since 1865
Â  Â  Â  Â  Â  Â  Â  Â  </span>
Â  Â  Â  Â  Â  Â  Â  Â  <ArrowRight className="w-5 h-5" />
Â  Â  Â  Â  Â  Â  Â  </motion.div>
Â  Â  Â  Â  Â  Â  </motion.div>

Â  Â  Â  Â  Â  Â  <motion.div
Â  Â  Â  Â  Â  Â  Â  initial={{ opacity: 0, scale: 0.8 }}
Â  Â  Â  Â  Â  Â  Â  animate={{ opacity: 1, scale: 1 }}
Â  Â  Â  Â  Â  Â  Â  transition={{ duration: 0.8, delay: 0.3 }}
Â  Â  Â  Â  Â  Â  Â  className="relative"
Â  Â  Â  Â  Â  Â  >
Â  Â  Â  Â  Â  Â  Â  <div className="w-full h-96 bg-gradient-to-br from-green-400/20 to-blue-400/20 rounded-2xl flex items-center justify-center backdrop-blur-sm border border-white/20">
Â  Â  Â  Â  Â  Â  Â  Â  <div className="text-center p-8">
Â  Â  Â  Â  Â  Â  Â  Â  Â  <Globe className="w-24 h-24 text-green-600 dark:text-green-400 mx-auto mb-4" />
Â  Â  Â  Â  Â  Â  Â  Â  Â  <h3 className="text-2xl font-bold text-gray-900 dark:text-white mb-2">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Global Impact
Â  Â  Â  Â  Â  Â  Â  Â  Â  </h3>
Â  Â  Â  Â  Â  Â  Â  Â  Â  <p className="text-gray-600 dark:text-gray-300">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Serving communities worldwide
Â  Â  Â  Â  Â  Â  Â  Â  Â  </p>
Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  </motion.div>
Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  </div>
Â  Â  Â  </section>

Â  Â  Â  {/* Mission Section */}
Â  Â  Â  <section className="py-20 bg-white dark:bg-gray-900">
Â  Â  Â  Â  <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
Â  Â  Â  Â  Â  <motion.div
Â  Â  Â  Â  Â  Â  initial={{ opacity: 0, y: 50 }}
Â  Â  Â  Â  Â  Â  whileInView={{ opacity: 1, y: 0 }}
Â  Â  Â  Â  Â  Â  transition={{ duration: 0.8 }}
Â  Â  Â  Â  Â  Â  viewport={{ once: true }}
Â  Â  Â  Â  Â  Â  className="text-center mb-16"
Â  Â  Â  Â  Â  >
Â  Â  Â  Â  Â  Â  <h2 className="text-3xl lg:text-5xl font-bold text-gray-900 dark:text-white mb-6">
Â  Â  Â  Â  Â  Â  Â  Our Mission
Â  Â  Â  Â  Â  Â  </h2>
Â  Â  Â  Â  Â  Â  <div className="max-w-4xl mx-auto">
Â  Â  Â  Â  Â  Â  Â  <p className="text-lg text-gray-600 dark:text-gray-300 leading-relaxed">
Â  Â  Â  Â  Â  Â  Â  Â  From the heart of the supply chain, we partner with farmers and
Â  Â  Â  Â  Â  Â  Â  Â  customers to source, make and deliver products that are vital
Â  Â  Â  Â  Â  Â  Â  Â  for living â€” from eggs to edible oils, salt to skincare, feed to
Â  Â  Â  Â  Â  Â  Â  Â  flooring. By supplying the things that matter, we help
Â  Â  Â  Â  Â  Â  Â  Â  businesses grow, communities prosper and consumers live well.
Â  Â  Â  Â  Â  Â  Â  </p>
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  </motion.div>

Â  Â  Â  Â  Â  {/* Feature Cards */}
Â  Â  Â  Â  Â  <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-8">
Â  Â  Â  Â  Â  Â  {[
Â  Â  Â  Â  Â  Â  Â  {
Â  Â  Â  Â  Â  Â  Â  Â  icon: Leaf,
Â  Â  Â  Â  Â  Â  Â  Â  title: "Sustainable",
Â  Â  Â  Â  Â  Â  Â  Â  description:
Â  Â  Â  Â  Â  Â  Â  Â  Â  "Committed to environmental responsibility and sustainable practices",
Â  Â  Â  Â  Â  Â  Â  Â  color: "from-green-500 to-emerald-500",
Â  Â  Â  Â  Â  Â  Â  },
Â  Â  Â  Â  Â  Â  Â  {
Â  Â  Â  Â  Â  Â  Â  Â  icon: Users,
Â  Â  Â  Â  Â  Â  Â  Â  title: "Community",
Â  Â  Â  Â  Â  Â  Â  Â  description:
Â  Â  Â  Â  Â  Â  Â  Â  Â  "Helping communities prosper through our global partnerships",
Â  Â  Â  Â  Â  Â  Â  Â  color: "from-blue-500 to-cyan-500",
Â  Â  Â  Â  Â  Â  Â  },
Â  Â  Â  Â  Â  Â  Â  {
Â  Â  Â  Â  Â  Â  Â  Â  icon: Globe,
Â  Â  Â  Â  Â  Â  Â  Â  title: "Global Reach",
Â  Â  Â  Â  Â  Â  Â  Â  description:
Â  Â  Â  Â  Â  Â  Â  Â  Â  "Serving customers and farmers worldwide since 1865",
Â  Â  Â  Â  Â  Â  Â  Â  color: "from-purple-500 to-pink-500",
Â  Â  Â  Â  Â  Â  Â  },
Â  Â  Â  Â  Â  Â  Â  {
Â  Â  Â  Â  Â  Â  Â  Â  icon: Award,
Â  Â  Â  Â  Â  Â  Â  Â  title: "Quality",
Â  Â  Â  Â  Â  Â  Â  Â  description:
Â  Â  Â  Â  Â  Â  Â  Â  Â  "Delivering premium products that are vital for living",
Â  Â  Â  Â  Â  Â  Â  Â  color: "from-orange-500 to-red-500",
Â  Â  Â  Â  Â  Â  Â  },
Â  Â  Â  Â  Â  Â  ].map((feature, index) => (
Â  Â  Â  Â  Â  Â  Â  <motion.div
Â  Â  Â  Â  Â  Â  Â  Â  key={feature.title}
Â  Â  Â  Â  Â  Â  Â  Â  initial={{ opacity: 0, y: 30 }}
Â  Â  Â  Â  Â  Â  Â  Â  whileInView={{ opacity: 1, y: 0 }}
Â  Â  Â  Â  Â  Â  Â  Â  transition={{ duration: 0.6, delay: index * 0.1 }}
Â  Â  Â  Â  Â  Â  Â  Â  viewport={{ once: true }}
Â  Â  Â  Â  Â  Â  Â  Â  className="bg-gray-50 dark:bg-gray-800 rounded-xl p-6 hover:shadow-lg transition-shadow duration-300"
Â  Â  Â  Â  Â  Â  Â  >
Â  Â  Â  Â  Â  Â  Â  Â  <div
Â  Â  Â  Â  Â  Â  Â  Â  Â  className={`inline-flex p-3 rounded-lg bg-gradient-to-r ${feature.color} mb-4`}
Â  Â  Â  Â  Â  Â  Â  Â  >
Â  Â  Â  Â  Â  Â  Â  Â  Â  <feature.icon className="w-6 h-6 text-white" />
Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  <h3 className="text-xl font-semibold text-gray-900 dark:text-white mb-2">
Â  Â  Â  Â  Â  Â  Â  Â  Â  {feature.title}
Â  Â  Â  Â  Â  Â  Â  Â  </h3>
Â  Â  Â  Â  Â  Â  Â  Â  <p className="text-gray-600 dark:text-gray-300">
Â  Â  Â  Â  Â  Â  Â  Â  Â  {feature.description}
Â  Â  Â  Â  Â  Â  Â  Â  </p>
Â  Â  Â  Â  Â  Â  Â  </motion.div>
Â  Â  Â  Â  Â  Â  ))}
Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  </div>
Â  Â  Â  </section>

Â  Â  Â  {/* Values Section */}
Â  Â  Â  <section className="py-20 bg-gradient-to-br from-green-50 to-blue-50 dark:from-green-950/10 dark:to-blue-950/10">
Â  Â  Â  Â  <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
Â  Â  Â  Â  Â  <div className="grid grid-cols-1 lg:grid-cols-2 gap-16 items-center">
Â  Â  Â  Â  Â  Â  <motion.div
Â  Â  Â  Â  Â  Â  Â  initial={{ opacity: 0, x: -50 }}
Â  Â  Â  Â  Â  Â  Â  whileInView={{ opacity: 1, x: 0 }}
Â  Â  Â  Â  Â  Â  Â  transition={{ duration: 0.8 }}
Â  Â  Â  Â  Â  Â  Â  viewport={{ once: true }}
Â  Â  Â  Â  Â  Â  >
Â  Â  Â  Â  Â  Â  Â  <h2 className="text-3xl lg:text-5xl font-bold text-gray-900 dark:text-white mb-6">
Â  Â  Â  Â  Â  Â  Â  Â  Family Values, Global Impact
Â  Â  Â  Â  Â  Â  Â  </h2>
Â  Â  Â  Â  Â  Â  Â  <p className="text-lg text-gray-600 dark:text-gray-300 mb-8 leading-relaxed">
Â  Â  Â  Â  Â  Â  Â  Â  As a family company, we understand the importance of trust,
Â  Â  Â  Â  Â  Â  Â  Â  integrity, and long-term relationships. These values guide
Â  Â  Â  Â  Â  Â  Â  Â  everything we do, from our partnerships with farmers to our
Â  Â  Â  Â  Â  Â  Â  Â  commitment to sustainable practices.
Â  Â  Â  Â  Â  Â  Â  </p>
Â  Â  Â  Â  Â  Â  Â  <div className="space-y-4">
Â  Â  Â  Â  Â  Â  Â  Â  {[
Â  Â  Â  Â  Â  Â  Â  Â  Â  "Safe and responsible operations",
Â  Â  Â  Â  Â  Â  Â  Â  Â  "Sustainable supply chain practices",
Â  Â  Â  Â  Â  Â  Â  Â  Â  "Innovation in food and agriculture",
Â  Â  Â  Â  Â  Â  Â  Â  Â  "Strong community partnerships",
Â  Â  Â  Â  Â  Â  Â  Â  ].map((value, index) => (
Â  Â  Â  Â  Â  Â  Â  Â  Â  <motion.div
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  key={value}
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  initial={{ opacity: 0, x: -30 }}
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  whileInView={{ opacity: 1, x: 0 }}
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  transition={{ duration: 0.6, delay: index * 0.1 }}
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  viewport={{ once: true }}
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  className="flex items-center"
Â  Â  Â  Â  Â  Â  Â  Â  Â  >
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div className="w-2 h-2 bg-green-500 rounded-full mr-4"></div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <span className="text-gray-700 dark:text-gray-300">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  {value}
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>
Â  Â  Â  Â  Â  Â  Â  Â  Â  </motion.div>
Â  Â  Â  Â  Â  Â  Â  Â  ))}
Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  </motion.div>

Â  Â  Â  Â  Â  Â  <motion.div
Â  Â  Â  Â  Â  Â  Â  initial={{ opacity: 0, scale: 0.9 }}
Â  Â  Â  Â  Â  Â  Â  whileInView={{ opacity: 1, scale: 1 }}
Â  Â  Â  Â  Â  Â  Â  transition={{ duration: 0.8 }}
Â  Â  Â  Â  Â  Â  Â  viewport={{ once: true }}
Â  Â  Â  Â  Â  Â  Â  className="relative"
Â  Â  Â  Â  Â  Â  >
Â  Â  Â  Â  Â  Â  Â  <div className="grid grid-cols-2 gap-4">
Â  Â  Â  Â  Â  Â  Â  Â  <div className="bg-white dark:bg-gray-800 rounded-xl p-6 shadow-lg">
Â  Â  Â  Â  Â  Â  Â  Â  Â  <h3 className="text-2xl font-bold text-green-600 dark:text-green-400 mb-2">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  158+
Â  Â  Â  Â  Â  Â  Â  Â  Â  </h3>
Â  Â  Â  Â  Â  Â  Â  Â  Â  <p className="text-gray-600 dark:text-gray-300">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Years of Experience
Â  Â  Â  Â  Â  Â  Â  Â  Â  </p>
Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  <div className="bg-white dark:bg-gray-800 rounded-xl p-6 shadow-lg">
Â  Â  Â  Â  Â  Â  Â  Â  Â  <h3 className="text-2xl font-bold text-blue-600 dark:text-blue-400 mb-2">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  70+
Â  Â  Â  Â  Â  Â  Â  Â  Â  </h3>
Â  Â  Â  Â  Â  Â  Â  Â  Â  <p className="text-gray-600 dark:text-gray-300">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Countries Served
Â  Â  Â  Â  Â  Â  Â  Â  Â  </p>
Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  <div className="bg-white dark:bg-gray-800 rounded-xl p-6 shadow-lg">
Â  Â  Â  Â  Â  Â  Â  Â  Â  <h3 className="text-2xl font-bold text-purple-600 dark:text-purple-400 mb-2">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  155K+
Â  Â  Â  Â  Â  Â  Â  Â  Â  </h3>
Â  Â  Â  Â  Â  Â  Â  Â  Â  <p className="text-gray-600 dark:text-gray-300">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Employees Worldwide
Â  Â  Â  Â  Â  Â  Â  Â  Â  </p>
Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  <div className="bg-white dark:bg-gray-800 rounded-xl p-6 shadow-lg">
Â  Â  Â  Â  Â  Â  Â  Â  Â  <h3 className="text-2xl font-bold text-orange-600 dark:text-orange-400 mb-2">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Global
Â  Â  Â  Â  Â  Â  Â  Â  Â  </h3>
Â  Â  Â  Â  Â  Â  Â  Â  Â  <p className="text-gray-600 dark:text-gray-300">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Supply Chain
Â  Â  Â  Â  Â  Â  Â  Â  Â  </p>
Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  </motion.div>
Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  </div>
Â  Â  Â  </section>

Â  Â  Â  {/* Cognizant Partnership Section */}
Â  Â  Â  <section className="py-20 bg-gradient-to-r from-green-600 to-blue-600 relative overflow-hidden">
Â  Â  Â  Â  {/* Background Pattern */}
Â  Â  Â  Â  <div className="absolute inset-0 opacity-10">
Â  Â  Â  Â  Â  <div className="absolute inset-0 bg-gradient-to-r from-transparent via-white/5 to-transparent animate-pulse"></div>
Â  Â  Â  Â  </div>

Â  Â  Â  Â  <div className="relative max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
Â  Â  Â  Â  Â  <div className="text-center mb-16">
Â  Â  Â  Â  Â  Â  <motion.div
Â  Â  Â  Â  Â  Â  Â  initial={{ opacity: 0, y: 50 }}
Â  Â  Â  Â  Â  Â  Â  whileInView={{ opacity: 1, y: 0 }}
Â  Â  Â  Â  Â  Â  Â  transition={{ duration: 0.8 }}
Â  Â  Â  Â  Â  Â  Â  viewport={{ once: true }}
Â  Â  Â  Â  Â  Â  >
Â  Â  Â  Â  Â  Â  Â  <h2 className="text-3xl lg:text-5xl font-bold text-white mb-6">
Â  Â  Â  Â  Â  Â  Â  Â  Powered by{" "}
Â  Â  Â  Â  Â  Â  Â  Â  <span className="text-transparent bg-clip-text bg-gradient-to-r from-cyan-400 to-blue-400">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Innovation
Â  Â  Â  Â  Â  Â  Â  Â  </span>
Â  Â  Â  Â  Â  Â  Â  </h2>
Â  Â  Â  Â  Â  Â  Â  <p className="text-xl text-blue-100 max-w-3xl mx-auto leading-relaxed">
Â  Â  Â  Â  Â  Â  Â  Â  Our partnership with Cognizant drives digital transformation,
Â  Â  Â  Â  Â  Â  Â  Â  bringing cutting-edge technology solutions to enhance global
Â  Â  Â  Â  Â  Â  Â  Â  food systems and agricultural innovation.
Â  Â  Â  Â  Â  Â  Â  </p>
Â  Â  Â  Â  Â  Â  </motion.div>
Â  Â  Â  Â  Â  </div>

Â  Â  Â  Â  Â  <div className="grid grid-cols-1 lg:grid-cols-2 gap-16 items-center">
Â  Â  Â  Â  Â  Â  {/* Left Side - Partnership Story */}
Â  Â  Â  Â  Â  Â  <motion.div
Â  Â  Â  Â  Â  Â  Â  initial={{ opacity: 0, x: -50 }}
Â  Â  Â  Â  Â  Â  Â  whileInView={{ opacity: 1, x: 0 }}
Â  Â  Â  Â  Â  Â  Â  transition={{ duration: 0.8, delay: 0.2 }}
Â  Â  Â  Â  Â  Â  Â  viewport={{ once: true }}
Â  Â  Â  Â  Â  Â  Â  className="space-y-8"
Â  Â  Â  Â  Â  Â  >
Â  Â  Â  Â  Â  Â  Â  <div className="bg-white/10 backdrop-blur-sm rounded-2xl p-8 border border-white/20">
Â  Â  Â  Â  Â  Â  Â  Â  <div className="flex items-center mb-6">
Â  Â  Â  Â  Â  Â  Â  Â  Â  <motion.div
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  initial={{ scale: 0 }}
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  whileInView={{ scale: 1 }}
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  transition={{ duration: 0.5, delay: 0.4 }}
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  viewport={{ once: true }}
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  className="w-16 h-16 bg-gradient-to-r from-cyan-500 to-blue-500 rounded-full flex items-center justify-center mr-4"
Â  Â  Â  Â  Â  Â  Â  Â  Â  >
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <svg
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  className="w-8 h-8 text-white"
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  fill="currentColor"
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  viewBox="0 0 20 20"
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  >
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <path
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  fillRule="evenodd"
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  d="M11.3 1.046A1 1 0 0112 2v5h4a1 1 0 01.82 1.573l-7 10A1 1 0 018 18v-5H4a1 1 0 01-.82-1.573l7-10a1 1 0 011.12-.381z"
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  clipRule="evenodd"
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  />
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </svg>
Â  Â  Â  Â  Â  Â  Â  Â  Â  </motion.div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  <h3 className="text-2xl font-bold text-white">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Strategic Alliance
Â  Â  Â  Â  Â  Â  Â  Â  Â  </h3>
Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  <p className="text-blue-100 leading-relaxed mb-6">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Cargill and Cognizant have forged a strategic partnership that
Â  Â  Â  Â  Â  Â  Â  Â  Â  combines Cargill's deep agricultural expertise with
Â  Â  Â  Â  Â  Â  Â  Â  Â  Cognizant's digital innovation capabilities, creating
Â  Â  Â  Â  Â  Â  Â  Â  Â  transformative solutions for the global food supply chain.
Â  Â  Â  Â  Â  Â  Â  Â  </p>
Â  Â  Â  Â  Â  Â  Â  Â  <motion.div
Â  Â  Â  Â  Â  Â  Â  Â  Â  initial={{ opacity: 0, y: 20 }}
Â  Â  Â  Â  Â  Â  Â  Â  Â  whileInView={{ opacity: 1, y: 0 }}
Â  Â  Â  Â  Â  Â  Â  Â  Â  transition={{ duration: 0.6, delay: 0.6 }}
Â  Â  Â  Â  Â  Â  Â  Â  Â  viewport={{ once: true }}
Â  Â  Â  Â  Â  Â  Â  Â  Â  className="flex items-center text-cyan-300 font-semibold"
Â  Â  Â  Â  Â  Â  Â  Â  >
Â  Â  Â  Â  Â  Â  Â  Â  Â  <span className="w-2 h-2 bg-cyan-400 rounded-full mr-3 animate-pulse"></span>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Transforming agriculture through technology
Â  Â  Â  Â  Â  Â  Â  Â  </motion.div>
Â  Â  Â  Â  Â  Â  Â  </div>

Â  Â  Â  Â  Â  Â  Â  {/* Key Benefits */}
Â  Â  Â  Â  Â  Â  Â  <div className="space-y-4">
Â  Â  Â  Â  Â  Â  Â  Â  {[
Â  Â  Â  Â  Â  Â  Â  Â  Â  {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  title: "Digital Transformation",
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  desc: "Modern solutions for traditional agriculture",
Â  Â  Â  Â  Â  Â  Â  Â  Â  },
Â  Â  Â  Â  Â  Â  Â  Â  Â  {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  title: "Data Analytics",
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  desc: "Insights that drive better decision making",
Â  Â  Â  Â  Â  Â  Â  Â  Â  },
Â  Â  Â  Â  Â  Â  Â  Â  Â  {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  title: "Supply Chain Innovation",
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  desc: "Streamlined operations from farm to table",
Â  Â  Â  Â  Â  Â  Â  Â  Â  },
Â  Â  Â  Â  Â  Â  Â  Â  ].map((benefit, index) => (
Â  Â  Â  Â  Â  Â  Â  Â  Â  <motion.div
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  key={benefit.title}
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  initial={{ opacity: 0, x: -30 }}
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  whileInView={{ opacity: 1, x: 0 }}
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  transition={{ duration: 0.6, delay: 0.8 + index * 0.1 }}
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  viewport={{ once: true }}
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  className="flex items-start bg-white/5 backdrop-blur-sm rounded-lg p-4 border border-white/10 hover:bg-white/10 transition-all duration-300"
Â  Â  Â  Â  Â  Â  Â  Â  Â  >
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div className="w-2 h-2 bg-gradient-to-r from-cyan-400 to-blue-400 rounded-full mt-2 mr-4"></div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <h4 className="text-white font-semibold mb-1">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  {benefit.title}
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </h4>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <p className="text-blue-200 text-sm">{benefit.desc}</p>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  </motion.div>
Â  Â  Â  Â  Â  Â  Â  Â  ))}
Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  </motion.div>

Â  Â  Â  Â  Â  Â  {/* Right Side - Visual Elements */}
Â  Â  Â  Â  Â  Â  <motion.div
Â  Â  Â  Â  Â  Â  Â  initial={{ opacity: 0, scale: 0.8 }}
Â  Â  Â  Â  Â  Â  Â  whileInView={{ opacity: 1, scale: 1 }}
Â  Â  Â  Â  Â  Â  Â  transition={{ duration: 0.8, delay: 0.3 }}
Â  Â  Â  Â  Â  Â  Â  viewport={{ once: true }}
Â  Â  Â  Â  Â  Â  Â  className="relative"
Â  Â  Â  Â  Â  Â  >
Â  Â  Â  Â  Â  Â  Â  {/* Main Partnership Visual */}
Â  Â  Â  Â  Â  Â  Â  <div className="relative bg-gradient-to-br from-white/10 to-white/5 backdrop-blur-sm rounded-3xl p-8 border border-white/20">
Â  Â  Â  Â  Â  Â  Â  Â  {/* Floating Elements */}
Â  Â  Â  Â  Â  Â  Â  Â  <motion.div
Â  Â  Â  Â  Â  Â  Â  Â  Â  animate={{
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  y: [-10, 10, -10],
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  rotate: [0, 5, 0],
Â  Â  Â  Â  Â  Â  Â  Â  Â  }}
Â  Â  Â  Â  Â  Â  Â  Â  Â  transition={{
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  duration: 6,
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  repeat: Infinity,
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  ease: "easeInOut",
Â  Â  Â  Â  Â  Â  Â  Â  Â  }}
Â  Â  Â  Â  Â  Â  Â  Â  Â  className="absolute -top-4 -right-4 w-16 h-16 bg-gradient-to-r from-cyan-400 to-blue-500 rounded-2xl opacity-80"
Â  Â  Â  Â  Â  Â  Â  Â  ></motion.div>

Â  Â  Â  Â  Â  Â  Â  Â  <motion.div
Â  Â  Â  Â  Â  Â  Â  Â  Â  animate={{
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  y: [10, -10, 10],
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  rotate: [0, -5, 0],
Â  Â  Â  Â  Â  Â  Â  Â  Â  }}
Â  Â  Â  Â  Â  Â  Â  Â  Â  transition={{
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  duration: 8,
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  repeat: Infinity,
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  ease: "easeInOut",
Â  Â  Â  Â  Â  Â  Â  Â  Â  }}
Â  Â  Â  Â  Â  Â  Â  Â  Â  className="absolute -bottom-4 -left-4 w-12 h-12 bg-gradient-to-r from-purple-400 to-indigo-500 rounded-xl opacity-60"
Â  Â  Â  Â  Â  Â  Â  Â  ></motion.div>

Â  Â  Â  Â  Â  Â  Â  Â  {/* Company Logos/Names */}
Â  Â  Â  Â  Â  Â  Â  Â  <div className="text-center space-y-8">
Â  Â  Â  Â  Â  Â  Â  Â  Â  <motion.div
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  initial={{ opacity: 0, y: 30 }}
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  whileInView={{ opacity: 1, y: 0 }}
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  transition={{ duration: 0.6, delay: 0.5 }}
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  viewport={{ once: true }}
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  className="bg-gradient-to-r from-green-500 to-emerald-500 text-white px-8 py-6 rounded-2xl shadow-2xl"
Â  Â  Â  Â  Â  Â  Â  Â  Â  >
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <h4 className="text-3xl font-bold">CARGILL</h4>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <p className="text-green-100 text-sm mt-2">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Agricultural Excellence
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </p>
Â  Â  Â  Â  Â  Â  Â  Â  Â  </motion.div>

Â  Â  Â  Â  Â  Â  Â  Â  Â  {/* Connection Element */}
Â  Â  Â  Â  Â  Â  Â  Â  Â  <motion.div
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  initial={{ scale: 0 }}
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  whileInView={{ scale: 1 }}
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  transition={{ duration: 0.8, delay: 0.7 }}
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  viewport={{ once: true }}
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  className="relative"
Â  Â  Â  Â  Â  Â  Â  Â  Â  >
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div className="flex items-center justify-center">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div className="w-16 h-1 bg-gradient-to-r from-cyan-400 to-purple-400"></div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <motion.div
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  animate={{ rotate: 360 }}
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  transition={{
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  duration: 10,
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  repeat: Infinity,
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  ease: "linear",
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  }}
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  className="w-8 h-8 bg-white rounded-full flex items-center justify-center mx-4"
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  >
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div className="w-3 h-3 bg-gradient-to-r from-cyan-500 to-purple-500 rounded-full"></div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </motion.div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div className="w-16 h-1 bg-gradient-to-r from-purple-400 to-blue-400"></div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  </motion.div>

Â  Â  Â  Â  Â  Â  Â  Â  Â  <motion.div
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  initial={{ opacity: 0, y: -30 }}
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  whileInView={{ opacity: 1, y: 0 }}
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  transition={{ duration: 0.6, delay: 0.9 }}
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  viewport={{ once: true }}
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  className="bg-gradient-to-r from-blue-600 to-indigo-600 text-white px-8 py-6 rounded-2xl shadow-2xl"
Â  Â  Â  Â  Â  Â  Â  Â  Â  >
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <h4 className="text-3xl font-bold">COGNIZANT</h4>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <p className="text-blue-100 text-sm mt-2">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Digital Innovation
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </p>
Â  Â  Â  Â  Â  Â  Â  Â  Â  </motion.div>
Â  Â  Â  Â  Â  Â  Â  Â  </div>

Â  Â  Â  Â  Â  Â  Â  Â  {/* Stats */}
Â  Â  Â  Â  Â  Â  Â  Â  <motion.div
Â  Â  Â  Â  Â  Â  Â  Â  Â  initial={{ opacity: 0, y: 30 }}
Â  Â  Â  Â  Â  Â  Â  Â  Â  whileInView={{ opacity: 1, y: 0 }}
Â  Â  Â  Â  Â  Â  Â  Â  Â  transition={{ duration: 0.8, delay: 1.1 }}
Â  Â  Â  Â  Â  Â  Â  Â  Â  viewport={{ once: true }}
Â  Â  Â  Â  Â  Â  Â  Â  Â  className="grid grid-cols-2 gap-4 mt-8"
Â  Â  Â  Â  Â  Â  Â  Â  >
Â  Â  Â  Â  Â  Â  Â  Â  Â  <div className="text-center p-4 bg-white/10 rounded-xl backdrop-blur-sm border border-white/20">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <motion.h5
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  initial={{ opacity: 0 }}
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  whileInView={{ opacity: 1 }}
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  transition={{ duration: 1, delay: 1.3 }}
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  viewport={{ once: true }}
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  className="text-2xl font-bold text-cyan-400"
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  >
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  10+
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </motion.h5>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <p className="text-white text-xs">Years Partnership</p>
Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  <div className="text-center p-4 bg-white/10 rounded-xl backdrop-blur-sm border border-white/20">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <motion.h5
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  initial={{ opacity: 0 }}
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  whileInView={{ opacity: 1 }}
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  transition={{ duration: 1, delay: 1.5 }}
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  viewport={{ once: true }}
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  className="text-2xl font-bold text-purple-400"
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  >
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  1000+
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </motion.h5>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <p className="text-white text-xs">Digital Solutions</p>
Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  </motion.div>
Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  </motion.div>
Â  Â  Â  Â  Â  </div>

Â  Â  Â  Â  Â  {/* Bottom CTA */}
Â  Â  Â  Â  Â  <motion.div
Â  Â  Â  Â  Â  Â  initial={{ opacity: 0, y: 30 }}
Â  Â  Â  Â  Â  Â  whileInView={{ opacity: 1, y: 0 }}
Â  Â  Â  Â  Â  Â  transition={{ duration: 0.8, delay: 1.2 }}
Â  Â  Â  Â  Â  Â  viewport={{ once: true }}
Â  Â  Â  Â  Â  Â  className="text-center mt-16"
Â  Â  Â  Â  Â  >
Â  Â  Â  Â  Â  Â  <div className="bg-white/10 backdrop-blur-sm rounded-2xl p-8 border border-white/20">
Â  Â  Â  Â  Â  Â  Â  <h3 className="text-2xl font-bold text-white mb-4">
Â  Â  Â  Â  Â  Â  Â  Â  Together, Shaping the Future of Agriculture
Â  Â  Â  Â  Â  Â  Â  </h3>
Â  Â  Â  Â  Â  Â  Â  <p className="text-blue-100 mb-6 max-w-2xl mx-auto">
Â  Â  Â  Â  Â  Â  Â  Â  Through innovative technology solutions and deep industry
Â  Â  Â  Â  Â  Â  Â  Â  expertise, we're creating sustainable, efficient, and scalable
Â  Â  Â  Â  Â  Â  Â  Â  systems that benefit farmers, businesses, and consumers
Â  Â  Â  Â  Â  Â  Â  Â  worldwide.
Â  Â  Â  Â  Â  Â  Â  </p>
Â  Â  Â  Â  Â  Â  Â  <motion.div
Â  Â  Â  Â  Â  Â  Â  Â  whileHover={{ scale: 1.05 }}
Â  Â  Â  Â  Â  Â  Â  Â  whileTap={{ scale: 0.95 }}
Â  Â  Â  Â  Â  Â  Â  Â  className="inline-flex items-center px-6 py-3 bg-gradient-to-r from-cyan-500 to-blue-500 text-white font-semibold rounded-lg hover:shadow-xl transition-all duration-300"
Â  Â  Â  Â  Â  Â  Â  >
Â  Â  Â  Â  Â  Â  Â  Â  Explore Our Solutions
Â  Â  Â  Â  Â  Â  Â  Â  <ArrowRight className="ml-2 w-4 h-4" />
Â  Â  Â  Â  Â  Â  Â  </motion.div>
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  </motion.div>
Â  Â  Â  Â  </div>
Â  Â  Â  </section>

Â  Â  Â  {/* CTA Section */}
Â  Â  Â  <section className="py-20 bg-white dark:bg-gray-900">
Â  Â  Â  Â  <div className="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 text-center">
Â  Â  Â  Â  Â  <motion.div
Â  Â  Â  Â  Â  Â  initial={{ opacity: 0, y: 30 }}
Â  Â  Â  Â  Â  Â  whileInView={{ opacity: 1, y: 0 }}
Â  Â  Â  Â  Â  Â  transition={{ duration: 0.8 }}
Â  Â  Â  Â  Â  Â  viewport={{ once: true }}
Â  Â  Â  Â  Â  >
Â  Â  Â  Â  Â  Â  <h2 className="text-3xl lg:text-4xl font-bold text-gray-900 dark:text-white mb-6">
Â  Â  Â  Â  Â  Â  Â  Nourishing the World Together
Â  Â  Â  Â  Â  Â  </h2>
Â  Â  Â  Â  Â  Â  <p className="text-lg text-gray-600 dark:text-gray-300 mb-8">
Â  Â  Â  Â  Â  Â  Â  Join us in our mission to provide essential services that help
Â  Â  Â  Â  Â  Â  Â  businesses grow, communities prosper, and consumers live well.
Â  Â  Â  Â  Â  Â  </p>
Â  Â  Â  Â  Â  Â  <motion.button
Â  Â  Â  Â  Â  Â  Â  whileHover={{ scale: 1.05 }}
Â  Â  Â  Â  Â  Â  Â  whileTap={{ scale: 0.95 }}
Â  Â  Â  Â  Â  Â  Â  className="inline-flex items-center px-8 py-4 bg-gradient-to-r from-green-600 to-blue-600 text-white font-semibold rounded-lg shadow-lg hover:shadow-xl transition-shadow duration-300"
Â  Â  Â  Â  Â  Â  >
Â  Â  Â  Â  Â  Â  Â  Learn More About Our Impact
Â  Â  Â  Â  Â  Â  Â  <ArrowRight className="ml-2 w-5 h-5" />
Â  Â  Â  Â  Â  Â  </motion.button>
Â  Â  Â  Â  Â  </motion.div>
Â  Â  Â  Â  </div>
Â  Â  Â  </section>
Â  Â  </div>
Â  );
}

>>>app/api/contract-data/route.ts
import { NextResponse } from 'next/server';
import { promises as fs } from 'fs';
import path from 'path';
import ExcelJS from 'exceljs';
import * as XLSX from 'xlsx';

export async function GET() {
Â  Â  try {
Â  Â  Â  Â  console.log('ğŸ” Starting to load contract data from Excel...');

Â  Â  Â  Â  // Get the Excel file path
Â  Â  Â  Â  const filePath = path.join(process.cwd(), 'public', 'data', 'ContractTracker.xlsx');
Â  Â  Â  Â  console.log('ğŸ“ Excel file path:', filePath);

Â  Â  Â  Â  // Let's also check what files are actually in the directory
Â  Â  Â  Â  try {
Â  Â  Â  Â  Â  Â  const dataDir = path.join(process.cwd(), 'public', 'data');
Â  Â  Â  Â  Â  Â  const files = await fs.readdir(dataDir);
Â  Â  Â  Â  Â  Â  console.log('ğŸ“ Files in data directory:', files);
Â  Â  Â  Â  } catch (dirError) {
Â  Â  Â  Â  Â  Â  console.error('âŒ Could not read data directory:', dirError);
Â  Â  Â  Â  }

Â  Â  Â  Â  // Check if file exists
Â  Â  Â  Â  try {
Â  Â  Â  Â  Â  Â  await fs.access(filePath);
Â  Â  Â  Â  Â  Â  console.log('âœ… Excel file exists');
Â  Â  Â  Â  } catch (error) {
Â  Â  Â  Â  Â  Â  console.error('âŒ Excel file not found:', filePath);
Â  Â  Â  Â  Â  Â  throw new Error(`Excel file not found: ${filePath}`);
Â  Â  Â  Â  }

Â  Â  Â  Â  // Try to load with ExcelJS first
Â  Â  Â  Â  let workbook: ExcelJS.Workbook | null = null;
Â  Â  Â  Â  let useXLSX = false;

Â  Â  Â  Â  try {
Â  Â  Â  Â  Â  Â  workbook = new ExcelJS.Workbook();
Â  Â  Â  Â  Â  Â  await workbook.xlsx.readFile(filePath);
Â  Â  Â  Â  Â  Â  console.log('ğŸ“Š Excel file loaded successfully with ExcelJS');
Â  Â  Â  Â  } catch (excelJSError) {
Â  Â  Â  Â  Â  Â  console.log('âš ï¸ ExcelJS failed, trying XLSX library:', excelJSError);
Â  Â  Â  Â  Â  Â  useXLSX = true;
Â  Â  Â  Â  Â  Â  workbook = null;
Â  Â  Â  Â  }

Â  Â  Â  Â  if (useXLSX) {
Â  Â  Â  Â  Â  Â  // Use XLSX library as fallback
Â  Â  Â  Â  Â  Â  console.log('ğŸ“Š Using XLSX library to read file');
Â  Â  Â  Â  Â  Â  const fileBuffer = await fs.readFile(filePath);
Â  Â  Â  Â  Â  Â  const xlsxWorkbook = XLSX.read(fileBuffer, { type: 'buffer' });

Â  Â  Â  Â  Â  Â  console.log('ğŸ“‹ XLSX Workbook sheet names:', xlsxWorkbook.SheetNames);

Â  Â  Â  Â  Â  Â  if (xlsxWorkbook.SheetNames.length === 0) {
Â  Â  Â  Â  Â  Â  Â  Â  throw new Error('No worksheets found in XLSX workbook');
Â  Â  Â  Â  Â  Â  }

Â  Â  Â  Â  Â  Â  // Look for "CBS India" worksheet specifically
Â  Â  Â  Â  Â  Â  let targetSheetName = xlsxWorkbook.SheetNames.find(name =>
Â  Â  Â  Â  Â  Â  Â  Â  name.includes('CBS India') || name === 'CBS India'
Â  Â  Â  Â  Â  Â  );

Â  Â  Â  Â  Â  Â  if (!targetSheetName) {
Â  Â  Â  Â  Â  Â  Â  Â  console.log('âš ï¸ CBS India worksheet not found, available sheets:', xlsxWorkbook.SheetNames);
Â  Â  Â  Â  Â  Â  Â  Â  targetSheetName = xlsxWorkbook.SheetNames[0]; // Fallback to first sheet
Â  Â  Â  Â  Â  Â  }

Â  Â  Â  Â  Â  Â  console.log('ğŸ“‹ Using worksheet:', targetSheetName);
Â  Â  Â  Â  Â  Â  const worksheet = xlsxWorkbook.Sheets[targetSheetName];

Â  Â  Â  Â  Â  Â  // Convert to JSON
Â  Â  Â  Â  Â  Â  const jsonData = XLSX.utils.sheet_to_json(worksheet, { header: 1 });
Â  Â  Â  Â  Â  Â  console.log('ğŸ“‹ XLSX Data rows:', jsonData.length);
Â  Â  Â  Â  Â  Â  console.log('ğŸ“‹ XLSX Header row:', jsonData[0]);

Â  Â  Â  Â  Â  Â  const contracts: any[] = [];

Â  Â  Â  Â  Â  Â  // Process XLSX data - specifically targeting column L (index 11)
Â  Â  Â  Â  Â  Â  for (let i = 1; i < jsonData.length; i++) {
Â  Â  Â  Â  Â  Â  Â  Â  const row = jsonData[i] as any[];

Â  Â  Â  Â  Â  Â  Â  Â  if (row.length < 12) continue; // Skip rows that don't have column L

Â  Â  Â  Â  Â  Â  Â  Â  // Extract contract status from column L (index 11, 0-based)
Â  Â  Â  Â  Â  Â  Â  Â  const contractStatus = String(row[11] || '').trim();

Â  Â  Â  Â  Â  Â  Â  Â  // Skip empty status rows
Â  Â  Â  Â  Â  Â  Â  Â  if (!contractStatus || contractStatus === 'undefined' || contractStatus === 'null') {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  continue;
Â  Â  Â  Â  Â  Â  Â  Â  }

Â  Â  Â  Â  Â  Â  Â  Â  const contract = {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  id: String(row[0] || `CTR-${String(i).padStart(3, '0')}`),
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  title: String(row[1] || row[2] || row[3] || 'Contract Entry'), // Try multiple columns for title
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  client: String(row[4] || row[5] || 'CBS India'),
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  value: String(row[6] || row[7] || '$0'),
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  startDate: row[8] ? new Date(row[8]).toISOString().split('T')[0] : new Date().toISOString().split('T')[0],
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  endDate: row[9] ? new Date(row[9]).toISOString().split('T')[0] : new Date().toISOString().split('T')[0],
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  status: contractStatus, // Column L (index 11 in 0-based)
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  type: String(row[10] || 'General'),
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  region: 'India',
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  progress: Math.min(100, Math.max(0, Number(row[12]) || Math.floor(Math.random() * 100)))
Â  Â  Â  Â  Â  Â  Â  Â  };

Â  Â  Â  Â  Â  Â  Â  Â  if (i <= 10) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  console.log(`ğŸ” XLSX Row ${i} Contract Status from Column L:`, contractStatus);
Â  Â  Â  Â  Â  Â  Â  Â  }

Â  Â  Â  Â  Â  Â  Â  Â  contracts.push(contract);
Â  Â  Â  Â  Â  Â  }

Â  Â  Â  Â  Â  Â  console.log('âœ… Successfully loaded', contracts.length, 'contracts from CBS India worksheet');
Â  Â  Â  Â  Â  Â  console.log('ğŸ“Š XLSX Status distribution:', contracts.reduce((acc: { [key: string]: number }, contract) => {
Â  Â  Â  Â  Â  Â  Â  Â  acc[contract.status] = (acc[contract.status] || 0) + 1;
Â  Â  Â  Â  Â  Â  Â  Â  return acc;
Â  Â  Â  Â  Â  Â  }, {}));

Â  Â  Â  Â  Â  Â  return NextResponse.json(contracts);
Â  Â  Â  Â  }

Â  Â  Â  Â  // Continue with ExcelJS processing
Â  Â  Â  Â  if (!workbook) {
Â  Â  Â  Â  Â  Â  throw new Error('Workbook not loaded properly');
Â  Â  Â  Â  }

Â  Â  Â  Â  console.log('ğŸ“‹ Workbook properties:', {
Â  Â  Â  Â  Â  Â  worksheets: workbook.worksheets.length,
Â  Â  Â  Â  Â  Â  calcProperties: workbook.calcProperties,
Â  Â  Â  Â  Â  Â  creator: workbook.creator,
Â  Â  Â  Â  Â  Â  lastModifiedBy: workbook.lastModifiedBy,
Â  Â  Â  Â  Â  Â  created: workbook.created,
Â  Â  Â  Â  Â  Â  modified: workbook.modified
Â  Â  Â  Â  });

Â  Â  Â  Â  // Debug: Check all worksheets
Â  Â  Â  Â  console.log('ğŸ“‹ Total worksheets in workbook:', workbook.worksheets.length);

Â  Â  Â  Â  if (workbook.worksheets.length === 0) {
Â  Â  Â  Â  Â  Â  console.error('âŒ No worksheets found in the workbook at all!');
Â  Â  Â  Â  Â  Â  throw new Error('No worksheets found in workbook');
Â  Â  Â  Â  }

Â  Â  Â  Â  console.log('ğŸ“‹ Worksheet names:', workbook.worksheets.map(ws => ws.name));
Â  Â  Â  Â  console.log('ğŸ“‹ Worksheet details:', workbook.worksheets.map(ws => ({
Â  Â  Â  Â  Â  Â  name: ws.name,
Â  Â  Â  Â  Â  Â  id: ws.id,
Â  Â  Â  Â  Â  Â  state: ws.state,
Â  Â  Â  Â  Â  Â  rowCount: ws.rowCount,
Â  Â  Â  Â  Â  Â  columnCount: ws.columnCount
Â  Â  Â  Â  })));

Â  Â  Â  Â  // Find CBS India worksheet specifically
Â  Â  Â  Â  let worksheet = workbook.worksheets.find(ws =>
Â  Â  Â  Â  Â  Â  ws.name.includes('CBS India') || ws.name === 'CBS India'
Â  Â  Â  Â  );

Â  Â  Â  Â  if (!worksheet) {
Â  Â  Â  Â  Â  Â  console.log('âš ï¸ CBS India worksheet not found, looking for alternatives...');
Â  Â  Â  Â  Â  Â  // Fallback to any visible worksheet
Â  Â  Â  Â  Â  Â  worksheet = workbook.worksheets.find(ws => ws.state === 'visible');
Â  Â  Â  Â  }

Â  Â  Â  Â  // If still no worksheet, try the first one regardless of visibility
Â  Â  Â  Â  if (!worksheet) {
Â  Â  Â  Â  Â  Â  worksheet = workbook.worksheets[0];
Â  Â  Â  Â  Â  Â  console.log('âš ï¸ Using first worksheet (may be hidden):', worksheet?.name);
Â  Â  Â  Â  }

Â  Â  Â  Â  if (!worksheet) {
Â  Â  Â  Â  Â  Â  console.error('âŒ No worksheet found in the workbook');
Â  Â  Â  Â  Â  Â  throw new Error('No worksheet found');
Â  Â  Â  Â  }

Â  Â  Â  Â  console.log('ğŸ“„ Using worksheet:', worksheet.name);
Â  Â  Â  Â  console.log('ğŸ“„ Worksheet ID:', worksheet.id);
Â  Â  Â  Â  console.log('ğŸ“„ Worksheet row count:', worksheet.rowCount);
Â  Â  Â  Â  console.log('ğŸ“„ Worksheet column count:', worksheet.columnCount);

Â  Â  Â  Â  const contracts: any[] = [];

Â  Â  Â  Â  // First, let's check the header row to understand the structure
Â  Â  Â  Â  const headerRow = worksheet.getRow(1);
Â  Â  Â  Â  console.log('ğŸ“‹ Header row values:', headerRow.values);

Â  Â  Â  Â  // Skip header row and iterate through data rows
Â  Â  Â  Â  worksheet.eachRow((row, rowNumber) => {
Â  Â  Â  Â  Â  Â  if (rowNumber === 1) return; // Skip header row

Â  Â  Â  Â  Â  Â  const cells = row.values as (string | number | Date | null)[];

Â  Â  Â  Â  Â  Â  // Log first few rows to understand the structure
Â  Â  Â  Â  Â  Â  if (rowNumber <= 10) {
Â  Â  Â  Â  Â  Â  Â  Â  console.log(`ğŸ” Row ${rowNumber} data:`, cells);
Â  Â  Â  Â  Â  Â  Â  Â  console.log(`ğŸ” Row ${rowNumber} Column L (index 12):`, cells[12]);
Â  Â  Â  Â  Â  Â  }

Â  Â  Â  Â  Â  Â  // Extract contract status from column L (index 12, 1-based indexing in ExcelJS)
Â  Â  Â  Â  Â  Â  // Handle Excel formula objects properly
Â  Â  Â  Â  Â  Â  let contractStatus = '';
Â  Â  Â  Â  Â  Â  const cellValue = cells[12];

Â  Â  Â  Â  Â  Â  if (rowNumber <= 10) {
Â  Â  Â  Â  Â  Â  Â  Â  console.log(`ğŸ” Row ${rowNumber} Raw cell value type:`, typeof cellValue, 'Value:', cellValue);
Â  Â  Â  Â  Â  Â  }

Â  Â  Â  Â  Â  Â  if (typeof cellValue === 'object' && cellValue !== null && !(cellValue instanceof Date)) {
Â  Â  Â  Â  Â  Â  Â  Â  // Handle Excel formula objects (cast to any to avoid TypeScript issues)
Â  Â  Â  Â  Â  Â  Â  Â  const formulaObj = cellValue as any;

Â  Â  Â  Â  Â  Â  Â  Â  // Log formula object properties for debugging
Â  Â  Â  Â  Â  Â  Â  Â  if (rowNumber <= 10) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  console.log(`ğŸ” Row ${rowNumber} Formula object properties:`, Object.keys(formulaObj));
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  console.log(`ğŸ” Row ${rowNumber} Formula object:`, JSON.stringify(formulaObj, null, 2));
Â  Â  Â  Â  Â  Â  Â  Â  }

Â  Â  Â  Â  Â  Â  Â  Â  // Try multiple ways to extract the status value
Â  Â  Â  Â  Â  Â  Â  Â  if (formulaObj.text && formulaObj.text !== 'Invalid Date') {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  contractStatus = String(formulaObj.text).trim();
Â  Â  Â  Â  Â  Â  Â  Â  } else if (formulaObj.result && formulaObj.result !== 'Invalid Date') {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  contractStatus = String(formulaObj.result).trim();
Â  Â  Â  Â  Â  Â  Â  Â  } else if (formulaObj.value && formulaObj.value !== 'Invalid Date') {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  contractStatus = String(formulaObj.value).trim();
Â  Â  Â  Â  Â  Â  Â  Â  } else if (formulaObj.richText && Array.isArray(formulaObj.richText)) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  // Handle rich text format
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  contractStatus = formulaObj.richText.map((rt: any) => rt.text || '').join('').trim();
Â  Â  Â  Â  Â  Â  Â  Â  } else if (typeof formulaObj.valueOf === 'function') {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  // Try valueOf method
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const val = formulaObj.valueOf();
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  if (val && val !== 'Invalid Date') {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  contractStatus = String(val).trim();
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  Â  Â  } else if (formulaObj.formula) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  // Try to extract status from formula content
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const formula = String(formulaObj.formula);
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  if (formula.includes('"Active"') || formula.includes("'Active'")) contractStatus = 'Active';
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  else if (formula.includes('"Expired"') || formula.includes("'Expired'")) contractStatus = 'Expired';
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  else if (formula.includes('"Cancelled"') || formula.includes("'Cancelled'")) contractStatus = 'Cancelled';
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  else if (formula.includes('"In Progress"') || formula.includes("'In Progress'")) contractStatus = 'In Progress';
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  else if (formula.includes('"Expiring"') || formula.includes("'Expiring'")) contractStatus = 'Active'; // Treat "Expiring" as Active
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  else {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  console.log(`âš ï¸ Row ${rowNumber} Unhandled formula:`, formula);
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  contractStatus = 'Active'; // Default for formula objects
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  Â  Â  } else {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  // If all else fails, assume Active for valid formula objects
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  console.log(`âš ï¸ Row ${rowNumber} Unhandled formula object, defaulting to Active`);
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  contractStatus = 'Active';
Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  } else {
Â  Â  Â  Â  Â  Â  Â  Â  contractStatus = String(cellValue || '').trim();
Â  Â  Â  Â  Â  Â  }

Â  Â  Â  Â  Â  Â  // Convert "Invalid Date" to "Active" as these are likely formula objects that should be Active
Â  Â  Â  Â  Â  Â  if (contractStatus === 'Invalid Date' || contractStatus === '[object Object]') {
Â  Â  Â  Â  Â  Â  Â  Â  console.log(`ğŸ”§ Row ${rowNumber} Converting "${contractStatus}" to "Active"`);
Â  Â  Â  Â  Â  Â  Â  Â  contractStatus = 'Active';
Â  Â  Â  Â  Â  Â  }

Â  Â  Â  Â  Â  Â  // Skip completely empty status rows
Â  Â  Â  Â  Â  Â  if (!contractStatus || contractStatus === 'undefined' || contractStatus === 'null') {
Â  Â  Â  Â  Â  Â  Â  Â  return;
Â  Â  Â  Â  Â  Â  }

Â  Â  Â  Â  Â  Â  // Helper function to safely parse dates
Â  Â  Â  Â  Â  Â  const parseDate = (cellValue: any): string => {
Â  Â  Â  Â  Â  Â  Â  Â  if (!cellValue) return new Date().toISOString().split('T')[0];

Â  Â  Â  Â  Â  Â  Â  Â  try {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  if (cellValue instanceof Date) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  return cellValue.toISOString().split('T')[0];
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  if (typeof cellValue === 'object' && cellValue.result) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  // Handle Excel formula results
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  return new Date().toISOString().split('T')[0];
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const date = new Date(cellValue);
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  if (isNaN(date.getTime())) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  return new Date().toISOString().split('T')[0];
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  return date.toISOString().split('T')[0];
Â  Â  Â  Â  Â  Â  Â  Â  } catch (error) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  return new Date().toISOString().split('T')[0];
Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  };

Â  Â  Â  Â  Â  Â  const contract = {
Â  Â  Â  Â  Â  Â  Â  Â  id: String(cells[1] || `CTR-${String(rowNumber).padStart(3, '0')}`),
Â  Â  Â  Â  Â  Â  Â  Â  title: String(cells[13] || 'Contract Entry'), // Project / Change Order Name/ Services Description
Â  Â  Â  Â  Â  Â  Â  Â  client: String(cells[2] || 'CBS India'), // CBS Reporting Manager
Â  Â  Â  Â  Â  Â  Â  Â  value: String(cells[6] || '$0'), // SOW/Change order Value
Â  Â  Â  Â  Â  Â  Â  Â  startDate: parseDate(cells[9]), // CO Start Date
Â  Â  Â  Â  Â  Â  Â  Â  endDate: parseDate(cells[10]), // CO End date
Â  Â  Â  Â  Â  Â  Â  Â  status: contractStatus, // Contract Status (Column L, index 12)
Â  Â  Â  Â  Â  Â  Â  Â  type: String(cells[4] || 'General'), // Contract Type
Â  Â  Â  Â  Â  Â  Â  Â  region: 'India',
Â  Â  Â  Â  Â  Â  Â  Â  progress: Math.min(100, Math.max(0, Math.floor(Math.random() * 100)))
Â  Â  Â  Â  Â  Â  };

Â  Â  Â  Â  Â  Â  // Log contract status for debugging
Â  Â  Â  Â  Â  Â  if (rowNumber <= 10) {
Â  Â  Â  Â  Â  Â  Â  Â  console.log(`ğŸ” Row ${rowNumber} Contract Status from Column L:`, contract.status);
Â  Â  Â  Â  Â  Â  }

Â  Â  Â  Â  Â  Â  contracts.push(contract);
Â  Â  Â  Â  });

Â  Â  Â  Â  console.log('âœ… Successfully loaded', contracts.length, 'contracts from Excel');
Â  Â  Â  Â  console.log('ğŸ“Š Status distribution:', contracts.reduce((acc: { [key: string]: number }, contract) => {
Â  Â  Â  Â  Â  Â  acc[contract.status] = (acc[contract.status] || 0) + 1;
Â  Â  Â  Â  Â  Â  return acc;
Â  Â  Â  Â  }, {}));

Â  Â  Â  Â  return NextResponse.json(contracts);

Â  Â  } catch (error) {
Â  Â  Â  Â  console.error('âŒ Error loading contract data:', error);

Â  Â  Â  Â  // Return fallback data if Excel loading fails
Â  Â  Â  Â  const fallbackData = [
Â  Â  Â  Â  Â  Â  {
Â  Â  Â  Â  Â  Â  Â  Â  id: "CTR-001",
Â  Â  Â  Â  Â  Â  Â  Â  title: "Grain Supply Agreement",
Â  Â  Â  Â  Â  Â  Â  Â  client: "Global Foods Inc.",
Â  Â  Â  Â  Â  Â  Â  Â  value: "$2.5M",
Â  Â  Â  Â  Â  Â  Â  Â  startDate: "2024-01-15",
Â  Â  Â  Â  Â  Â  Â  Â  endDate: "2025-01-14",
Â  Â  Â  Â  Â  Â  Â  Â  status: "Active",
Â  Â  Â  Â  Â  Â  Â  Â  type: "Supply",
Â  Â  Â  Â  Â  Â  Â  Â  region: "North America",
Â  Â  Â  Â  Â  Â  Â  Â  progress: 75,
Â  Â  Â  Â  Â  Â  },
Â  Â  Â  Â  Â  Â  {
Â  Â  Â  Â  Â  Â  Â  Â  id: "CTR-002",
Â  Â  Â  Â  Â  Â  Â  Â  title: "Logistics Partnership",
Â  Â  Â  Â  Â  Â  Â  Â  client: "Transport Solutions Ltd.",
Â  Â  Â  Â  Â  Â  Â  Â  value: "$1.8M",
Â  Â  Â  Â  Â  Â  Â  Â  startDate: "2024-03-01",
Â  Â  Â  Â  Â  Â  Â  Â  endDate: "2024-12-31",
Â  Â  Â  Â  Â  Â  Â  Â  status: "Active",
Â  Â  Â  Â  Â  Â  Â  Â  type: "Services",
Â  Â  Â  Â  Â  Â  Â  Â  region: "Europe",
Â  Â  Â  Â  Â  Â  Â  Â  progress: 60,
Â  Â  Â  Â  Â  Â  },
Â  Â  Â  Â  Â  Â  {
Â  Â  Â  Â  Â  Â  Â  Â  id: "CTR-003",
Â  Â  Â  Â  Â  Â  Â  Â  title: "Animal Feed Contract",
Â  Â  Â  Â  Â  Â  Â  Â  client: "Livestock Partners Co.",
Â  Â  Â  Â  Â  Â  Â  Â  value: "$3.2M",
Â  Â  Â  Â  Â  Â  Â  Â  startDate: "2024-02-10",
Â  Â  Â  Â  Â  Â  Â  Â  endDate: "2025-02-09",
Â  Â  Â  Â  Â  Â  Â  Â  status: "Active",
Â  Â  Â  Â  Â  Â  Â  Â  type: "Supply",
Â  Â  Â  Â  Â  Â  Â  Â  region: "Asia-Pacific",
Â  Â  Â  Â  Â  Â  Â  Â  progress: 85,
Â  Â  Â  Â  Â  Â  },
Â  Â  Â  Â  Â  Â  {
Â  Â  Â  Â  Â  Â  Â  Â  id: "CTR-004",
Â  Â  Â  Â  Â  Â  Â  Â  title: "Test Expired Contract",
Â  Â  Â  Â  Â  Â  Â  Â  client: "Test Client",
Â  Â  Â  Â  Â  Â  Â  Â  value: "$1M",
Â  Â  Â  Â  Â  Â  Â  Â  startDate: "2023-01-01",
Â  Â  Â  Â  Â  Â  Â  Â  endDate: "2023-12-31",
Â  Â  Â  Â  Â  Â  Â  Â  status: "Expired",
Â  Â  Â  Â  Â  Â  Â  Â  type: "Testing",
Â  Â  Â  Â  Â  Â  Â  Â  region: "Global",
Â  Â  Â  Â  Â  Â  Â  Â  progress: 100,
Â  Â  Â  Â  Â  Â  },
Â  Â  Â  Â  Â  Â  {
Â  Â  Â  Â  Â  Â  Â  Â  id: "CTR-005",
Â  Â  Â  Â  Â  Â  Â  Â  title: "Test Cancelled Contract",
Â  Â  Â  Â  Â  Â  Â  Â  client: "Another Client",
Â  Â  Â  Â  Â  Â  Â  Â  value: "$500K",
Â  Â  Â  Â  Â  Â  Â  Â  startDate: "2024-01-01",
Â  Â  Â  Â  Â  Â  Â  Â  endDate: "2024-06-30",
Â  Â  Â  Â  Â  Â  Â  Â  status: "Cancelled",
Â  Â  Â  Â  Â  Â  Â  Â  type: "Testing",
Â  Â  Â  Â  Â  Â  Â  Â  region: "North America",
Â  Â  Â  Â  Â  Â  Â  Â  progress: 30,
Â  Â  Â  Â  Â  Â  },
Â  Â  Â  Â  Â  Â  {
Â  Â  Â  Â  Â  Â  Â  Â  id: "CTR-006",
Â  Â  Â  Â  Â  Â  Â  Â  title: "Test In Progress Contract",
Â  Â  Â  Â  Â  Â  Â  Â  client: "Progress Client",
Â  Â  Â  Â  Â  Â  Â  Â  value: "$750K",
Â  Â  Â  Â  Â  Â  Â  Â  startDate: "2024-06-01",
Â  Â  Â  Â  Â  Â  Â  Â  endDate: "2024-12-31",
Â  Â  Â  Â  Â  Â  Â  Â  status: "In Progress",
Â  Â  Â  Â  Â  Â  Â  Â  type: "Development",
Â  Â  Â  Â  Â  Â  Â  Â  region: "Europe",
Â  Â  Â  Â  Â  Â  Â  Â  progress: 65,
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  ];

Â  Â  Â  Â  return NextResponse.json(fallbackData);
Â  Â  }
}

>>>app/api/enterprise-data/route.js
import { NextResponse } from 'next/server';
import * as xlsx from 'node-xlsx';
import Papa from 'papaparse';
import * as fs from 'fs';
import * as path from 'path';

interface EnterpriseData {
Â  Â  id: string;
Â  Â  title: string;
Â  Â  icon: string;
Â  Â  color: string;
Â  Â  metrics: {
Â  Â  Â  Â  apps: number;
Â  Â  Â  Â  valueSavings: string;
Â  Â  Â  Â  vulnerabilities: number;
Â  Â  Â  Â  innovations: string;
Â  Â  Â  Â  p1: number;
Â  Â  };
Â  Â  items: BusinessUnitData[];
}

interface BusinessUnitData {
Â  Â  name: string;
Â  Â  apps: number;
Â  Â  valueSavings: string;
Â  Â  vulnerabilities: number;
Â  Â  innovations: number;
Â  Â  p1: number;
Â  Â  appBreakdown?: {
Â  Â  Â  Â  platinum: number;
Â  Â  Â  Â  gold: number;
Â  Â  Â  Â  silver: number;
Â  Â  Â  Â  bronze: number;
Â  Â  Â  Â  lead: number;
Â  Â  };
}

// Function to calculate enterprise totals from business unit metrics
function calculateEnterpriseMetrics(businessUnits: BusinessUnitData[]): {
Â  Â  apps: number;
Â  Â  valueSavings: string;
Â  Â  vulnerabilities: number;
Â  Â  innovations: string;
Â  Â  p1: number;
} {
Â  Â  const totalApps = businessUnits.reduce((sum, unit) => sum + unit.apps, 0);
Â  Â  const totalVulnerabilities = businessUnits.reduce((sum, unit) => sum + unit.vulnerabilities, 0);
Â  Â  const totalP1 = businessUnits.reduce((sum, unit) => sum + unit.p1, 0);

Â  Â  // Sum up value savings (remove $ and K, then add back)
Â  Â  const totalValueSavings = businessUnits.reduce((sum, unit) => {
Â  Â  Â  Â  const value = parseInt(unit.valueSavings.replace(/[$K]/g, ''));
Â  Â  Â  Â  return sum + value;
Â  Â  }, 0);

Â  Â  // Sum up innovations (remove +, then add back)
Â  Â  const totalInnovations = businessUnits.reduce((sum, unit) => {
Â  Â  Â  Â  return sum + unit.innovations;
Â  Â  }, 0);

Â  Â  return {
Â  Â  Â  Â  apps: totalApps,
Â  Â  Â  Â  valueSavings: `$${totalValueSavings}K`,
Â  Â  Â  Â  vulnerabilities: totalVulnerabilities,
Â  Â  Â  Â  innovations: `${totalInnovations}+`,
Â  Â  Â  Â  p1: totalP1
Â  Â  };
}

async function loadEnterpriseDataFromExcel(): Promise<EnterpriseData[]> {
Â  Â  try {
Â  Â  Â  Â  // Load Excel file from public directory
Â  Â  Â  Â  const filePath = path.join(process.cwd(), 'public', 'data', 'enterprise-metrics.xlsx');
Â  Â  Â  Â  const workbook = xlsx.parse(filePath);

Â  Â  Â  Â  // Get worksheet data - node-xlsx returns an array of worksheets
Â  Â  Â  Â  const enterpriseSheet = workbook.find(sheet => sheet.name === 'Enterprises');
Â  Â  Â  Â  const businessUnitsSheet = workbook.find(sheet => sheet.name === 'BusinessUnits');

Â  Â  Â  Â  if (!enterpriseSheet || !businessUnitsSheet) {
Â  Â  Â  Â  Â  Â  throw new Error('Required worksheets not found');
Â  Â  Â  Â  }

Â  Â  Â  Â  // Get data arrays (already in array format with node-xlsx)
Â  Â  Â  Â  const enterpriseJson = enterpriseSheet.data;
Â  Â  Â  Â  const businessUnitsJson = businessUnitsSheet.data;

Â  Â  Â  Â  // Process enterprise data (skip header row) - only basic info
Â  Â  Â  Â  const enterpriseRows = enterpriseJson.slice(1) as (string | number)[][];
Â  Â  Â  Â  const businessUnitRows = businessUnitsJson.slice(1) as (string | number)[][];

Â  Â  Â  Â  // Group business units WITH METRICS by enterprise ID
Â  Â  Â  Â  const businessUnitsByEnterprise: { [key: string]: BusinessUnitData[] } = {};

Â  Â  Â  Â  businessUnitRows.forEach(row => {
Â  Â  Â  Â  Â  Â  const enterpriseId = String(row[0]);
Â  Â  Â  Â  Â  Â  const unitData: BusinessUnitData = {
Â  Â  Â  Â  Â  Â  Â  Â  name: String(row[1]),
Â  Â  Â  Â  Â  Â  Â  Â  apps: Number(row[2]),
Â  Â  Â  Â  Â  Â  Â  Â  valueSavings: String(row[3]),
Â  Â  Â  Â  Â  Â  Â  Â  vulnerabilities: Number(row[4]),
Â  Â  Â  Â  Â  Â  Â  Â  innovations: Number(row[5]),
Â  Â  Â  Â  Â  Â  Â  Â  p1: Number(row[6]),
Â  Â  Â  Â  Â  Â  Â  Â  appBreakdown: {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  platinum: Number(row[7]) || 0,
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  gold: Number(row[8]) || 0,
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  silver: Number(row[9]) || 0,
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  bronze: Number(row[10]) || 0,
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  lead: Number(row[11]) || 0
Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  };

Â  Â  Â  Â  Â  Â  if (!businessUnitsByEnterprise[enterpriseId]) {
Â  Â  Â  Â  Â  Â  Â  Â  businessUnitsByEnterprise[enterpriseId] = [];
Â  Â  Â  Â  Â  Â  }

Â  Â  Â  Â  Â  Â  businessUnitsByEnterprise[enterpriseId].push(unitData);
Â  Â  Â  Â  });

Â  Â  Â  Â  // Map enterprise data and CALCULATE TOTALS from business units
Â  Â  Â  Â  const enterpriseData: EnterpriseData[] = enterpriseRows.map(row => {
Â  Â  Â  Â  Â  Â  const enterpriseId = String(row[0]);

Â  Â  Â  Â  Â  Â  // Get business units for this enterprise
Â  Â  Â  Â  Â  Â  const businessUnits = businessUnitsByEnterprise[enterpriseId] || [];

Â  Â  Â  Â  Â  Â  // CALCULATE enterprise metrics from business unit totals
Â  Â  Â  Â  Â  Â  const calculatedMetrics = calculateEnterpriseMetrics(businessUnits);

Â  Â  Â  Â  Â  Â  return {
Â  Â  Â  Â  Â  Â  Â  Â  id: enterpriseId,
Â  Â  Â  Â  Â  Â  Â  Â  title: String(row[1]),
Â  Â  Â  Â  Â  Â  Â  Â  icon: String(row[2]),
Â  Â  Â  Â  Â  Â  Â  Â  color: String(row[3]),
Â  Â  Â  Â  Â  Â  Â  Â  metrics: calculatedMetrics,
Â  Â  Â  Â  Â  Â  Â  Â  items: businessUnits
Â  Â  Â  Â  Â  Â  };
Â  Â  Â  Â  });

Â  Â  Â  Â  return enterpriseData;

Â  Â  } catch (error) {
Â  Â  Â  Â  console.error('Error loading Excel data:', error);
Â  Â  Â  Â  // Fallback to CSV if Excel fails
Â  Â  Â  Â  return loadEnterpriseDataFromCSV();
Â  Â  }
}

async function loadEnterpriseDataFromCSV(): Promise<EnterpriseData[]> {
Â  Â  try {
Â  Â  Â  Â  // Load enterprises CSV from file system
Â  Â  Â  Â  const enterpriseCsvPath = path.join(process.cwd(), 'public', 'data', 'enterprises.csv');
Â  Â  Â  Â  const businessUnitsCsvPath = path.join(process.cwd(), 'public', 'data', 'business-units.csv');

Â  Â  Â  Â  const enterpriseCSV = fs.readFileSync(enterpriseCsvPath, 'utf-8');
Â  Â  Â  Â  const businessUnitsCSV = fs.readFileSync(businessUnitsCsvPath, 'utf-8');

Â  Â  Â  Â  // Parse CSV data
Â  Â  Â  Â  const enterpriseResult = Papa.parse(enterpriseCSV, {
Â  Â  Â  Â  Â  Â  header: true,
Â  Â  Â  Â  Â  Â  skipEmptyLines: true
Â  Â  Â  Â  });

Â  Â  Â  Â  const businessUnitsResult = Papa.parse(businessUnitsCSV, {
Â  Â  Â  Â  Â  Â  header: true,
Â  Â  Â  Â  Â  Â  skipEmptyLines: true
Â  Â  Â  Â  });

Â  Â  Â  Â  if (enterpriseResult.errors.length > 0) {
Â  Â  Â  Â  Â  Â  console.error('Enterprise CSV parsing errors:', enterpriseResult.errors);
Â  Â  Â  Â  }

Â  Â  Â  Â  if (businessUnitsResult.errors.length > 0) {
Â  Â  Â  Â  Â  Â  console.error('Business Units CSV parsing errors:', businessUnitsResult.errors);
Â  Â  Â  Â  }

Â  Â  Â  Â  // Group business units WITH METRICS by enterprise ID
Â  Â  Â  Â  const businessUnitsByEnterprise: { [key: string]: BusinessUnitData[] } = {};

Â  Â  Â  Â  businessUnitsResult.data.forEach((row: any) => {
Â  Â  Â  Â  Â  Â  const enterpriseId = row['Enterprise ID'];
Â  Â  Â  Â  Â  Â  const unitData: BusinessUnitData = {
Â  Â  Â  Â  Â  Â  Â  Â  name: row['Business Unit Name'],
Â  Â  Â  Â  Â  Â  Â  Â  apps: parseInt(row['Apps']),
Â  Â  Â  Â  Â  Â  Â  Â  valueSavings: row['Value Savings'],
Â  Â  Â  Â  Â  Â  Â  Â  vulnerabilities: parseInt(row['Vulnerabilities']),
Â  Â  Â  Â  Â  Â  Â  Â  innovations: parseInt(row['Innovations']),
Â  Â  Â  Â  Â  Â  Â  Â  p1: parseInt(row['P1']),
Â  Â  Â  Â  Â  Â  Â  Â  appBreakdown: {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  platinum: parseInt(row['Platinum']) || 0,
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  gold: parseInt(row['Gold']) || 0,
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  silver: parseInt(row['Silver']) || 0,
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  bronze: parseInt(row['Bronze']) || 0,
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  lead: parseInt(row['Lead']) || 0
Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  };

Â  Â  Â  Â  Â  Â  if (!businessUnitsByEnterprise[enterpriseId]) {
Â  Â  Â  Â  Â  Â  Â  Â  businessUnitsByEnterprise[enterpriseId] = [];
Â  Â  Â  Â  Â  Â  }

Â  Â  Â  Â  Â  Â  businessUnitsByEnterprise[enterpriseId].push(unitData);
Â  Â  Â  Â  });

Â  Â  Â  Â  // Map enterprise data and CALCULATE TOTALS from business units
Â  Â  Â  Â  const enterpriseData: EnterpriseData[] = enterpriseResult.data.map((row: any) => {
Â  Â  Â  Â  Â  Â  const enterpriseId = row['Enterprise ID'];

Â  Â  Â  Â  Â  Â  // Get business units for this enterprise
Â  Â  Â  Â  Â  Â  const businessUnits = businessUnitsByEnterprise[enterpriseId] || [];

Â  Â  Â  Â  Â  Â  // CALCULATE enterprise metrics from business unit totals
Â  Â  Â  Â  Â  Â  const calculatedMetrics = calculateEnterpriseMetrics(businessUnits);

Â  Â  Â  Â  Â  Â  return {
Â  Â  Â  Â  Â  Â  Â  Â  id: enterpriseId,
Â  Â  Â  Â  Â  Â  Â  Â  title: row['Enterprise Name'],
Â  Â  Â  Â  Â  Â  Â  Â  icon: row['Icon'],
Â  Â  Â  Â  Â  Â  Â  Â  color: row['Color'],
Â  Â  Â  Â  Â  Â  Â  Â  metrics: calculatedMetrics,
Â  Â  Â  Â  Â  Â  Â  Â  items: businessUnits
Â  Â  Â  Â  Â  Â  };
Â  Â  Â  Â  });

Â  Â  Â  Â  return enterpriseData;

Â  Â  } catch (error) {
Â  Â  Â  Â  console.error('Error loading CSV data:', error);
Â  Â  Â  Â  return [];
Â  Â  }
}

// API route handler
export async function GET() {
Â  Â  try {
Â  Â  Â  Â  // Try to load from Excel first
Â  Â  Â  Â  const data = await loadEnterpriseDataFromExcel();
Â  Â  Â  Â  return NextResponse.json(data);
Â  Â  } catch (error) {
Â  Â  Â  Â  console.error('Error in API route:', error);
Â  Â  Â  Â  return NextResponse.json(
Â  Â  Â  Â  Â  Â  { error: 'Failed to load enterprise data' },
Â  Â  Â  Â  Â  Â  { status: 500 }
Â  Â  Â  Â  );
Â  Â  }
}

>>>app/contact/page.tsx
export default function ContactPage() {
Â  return <div>Contact page</div>;
}

>>>app/dashboard/data.ts
import { TrendingUp, Building2, Utensils, Heart, Ship, Globe, Shield, Factory, BarChart3, Coins, Leaf, Zap, Gem, Wheat, BriefcaseBusiness, Earth, ShoppingCart, Salad, Droplet, Bird, ChevronRight } from "lucide-react";

// Icon mapping function
export const getIconFromName = (iconName: string) => {
Â  Â  const iconMap: {
Â  Â  Â  Â  [key: string]: React.ComponentType<{ className?: string }>;
Â  Â  } = {
Â  Â  Â  Â  TrendingUp: TrendingUp,
Â  Â  Â  Â  Building2: Building2,
Â  Â  Â  Â  Utensils: Utensils,
Â  Â  Â  Â  Heart: Heart,
Â  Â  Â  Â  Ship: Ship,
Â  Â  Â  Â  Globe: Globe,
Â  Â  Â  Â  Shield: Shield,
Â  Â  Â  Â  Factory: Factory,
Â  Â  Â  Â  BarChart3: BarChart3,
Â  Â  Â  Â  Coins: Coins,
Â  Â  Â  Â  Leaf: Leaf,
Â  Â  Â  Â  Zap: Zap,
Â  Â  Â  Â  Gem: Gem,
Â  Â  Â  Â  Wheat: Wheat,
Â  Â  Â  Â  BriefcaseBusiness: BriefcaseBusiness,
Â  Â  Â  Â  Earth: Earth,
Â  Â  Â  Â  ShoppingCart: ShoppingCart,
Â  Â  Â  Â  Salad: Salad,
Â  Â  Â  Â  Droplet: Droplet,
Â  Â  Â  Â  Bird: Bird,
Â  Â  };
Â  Â  return iconMap[iconName] || ChevronRight;
};

export const getItemIcon = (itemName: string) => {
Â  Â  if (itemName.includes("Asia Pacific")) return Globe;
Â  Â  if (itemName.includes("Europe") || itemName.includes("Middle East"))
Â  Â  Â  Â  return Building2;
Â  Â  if (itemName.includes("North America")) return Factory;
Â  Â  if (itemName.includes("Latin America")) return Leaf;
Â  Â  if (itemName.includes("Ocean") || itemName.includes("Transportation"))
Â  Â  Â  Â  return Ship;
Â  Â  if (itemName.includes("Commercial")) return ShoppingCart;
Â  Â  if (itemName.includes("World")) return Earth;
Â  Â  if (itemName.includes("Food")) return Salad;
Â  Â  if (itemName.includes("Animal")) return Bird;
Â  Â  if (itemName.includes("Deicing")) return Droplet;
Â  Â  if (itemName.includes("Trading")) return BarChart3;
Â  Â  if (itemName.includes("Risk")) return Shield;
Â  Â  if (itemName.includes("Metals")) return Coins;
Â  Â  if (itemName.includes("Capital")) return TrendingUp;
Â  Â  if (itemName.includes("Commercial")) return BarChart3;
Â  Â  if (itemName.includes("Bioindustrial")) return Leaf;
Â  Â  if (itemName.includes("Deicing")) return Zap;
Â  Â  return ChevronRight;
};

export const getEnterpriseStatus = (p1: number, vulnerabilities: number) => {
Â  Â  // Check P1 condition first (higher priority)
Â  Â  if (p1 > 0) {
Â  Â  Â  Â  return {
Â  Â  Â  Â  Â  Â  status: "danger",
Â  Â  Â  Â  Â  Â  color: "red",
Â  Â  Â  Â  Â  Â  bgPulse: "bg-red-500/20 dark:bg-red-500/10",
Â  Â  Â  Â  Â  Â  borderColor: "border-red-300/50 dark:border-red-600/50",
Â  Â  Â  Â  Â  Â  indicatorColor: "bg-red-500",
Â  Â  Â  Â  Â  Â  shadowColor: "shadow-red-500/20",
Â  Â  Â  Â  Â  Â  cardBgColor:
Â  Â  Â  Â  Â  Â  Â  Â  "from-red-25 to-red-50 dark:from-red-950/20 dark:to-red-900/20",
Â  Â  Â  Â  Â  Â  label: "High Priority Issues",
Â  Â  Â  Â  };
Â  Â  }

Â  Â  // Check vulnerabilities condition
Â  Â  if (vulnerabilities > 1000) {
Â  Â  Â  Â  return {
Â  Â  Â  Â  Â  Â  status: "danger",
Â  Â  Â  Â  Â  Â  color: "red",
Â  Â  Â  Â  Â  Â  bgPulse: "bg-red-500/20 dark:bg-red-500/10",
Â  Â  Â  Â  Â  Â  borderColor: "border-red-300/50 dark:border-red-600/50",
Â  Â  Â  Â  Â  Â  indicatorColor: "bg-red-500",
Â  Â  Â  Â  Â  Â  shadowColor: "shadow-red-500/20",
Â  Â  Â  Â  Â  Â  cardBgColor:
Â  Â  Â  Â  Â  Â  Â  Â  "from-red-25 to-red-50 dark:from-red-950/20 dark:to-red-900/20",
Â  Â  Â  Â  Â  Â  label: "Critical Vulnerabilities",
Â  Â  Â  Â  };
Â  Â  }

Â  Â  // Check warning conditions
Â  Â  if (p1 <= 3 && p1 > 0) {
Â  Â  Â  Â  return {
Â  Â  Â  Â  Â  Â  status: "warning",
Â  Â  Â  Â  Â  Â  color: "yellow",
Â  Â  Â  Â  Â  Â  bgPulse: "bg-yellow-500/20 dark:bg-yellow-500/10",
Â  Â  Â  Â  Â  Â  borderColor: "border-yellow-300/50 dark:border-yellow-600/50",
Â  Â  Â  Â  Â  Â  indicatorColor: "bg-yellow-500",
Â  Â  Â  Â  Â  Â  shadowColor: "shadow-yellow-500/20",
Â  Â  Â  Â  Â  Â  cardBgColor:
Â  Â  Â  Â  Â  Â  Â  Â  "from-yellow-25 to-yellow-50 dark:from-yellow-950/20 dark:to-yellow-900/20",
Â  Â  Â  Â  Â  Â  label: "Monitor Required",
Â  Â  Â  Â  };
Â  Â  }

Â  Â  if (vulnerabilities > 150) {
Â  Â  Â  Â  return {
Â  Â  Â  Â  Â  Â  status: "warning",
Â  Â  Â  Â  Â  Â  color: "yellow",
Â  Â  Â  Â  Â  Â  bgPulse: "bg-yellow-500/20 dark:bg-yellow-500/10",
Â  Â  Â  Â  Â  Â  borderColor: "border-yellow-300/50 dark:border-yellow-600/50",
Â  Â  Â  Â  Â  Â  indicatorColor: "bg-yellow-500",
Â  Â  Â  Â  Â  Â  shadowColor: "shadow-yellow-500/20",
Â  Â  Â  Â  Â  Â  cardBgColor:
Â  Â  Â  Â  Â  Â  Â  Â  "from-yellow-25 to-yellow-50 dark:from-yellow-950/20 dark:to-yellow-900/20",
Â  Â  Â  Â  Â  Â  label: "Elevated Vulnerabilities",
Â  Â  Â  Â  };
Â  Â  }

Â  Â  // Safe condition
Â  Â  return {
Â  Â  Â  Â  status: "safe",
Â  Â  Â  Â  color: "green",
Â  Â  Â  Â  bgPulse: "bg-green-500/20 dark:bg-green-500/10",
Â  Â  Â  Â  borderColor: "border-green-300/50 dark:border-green-600/50",
Â  Â  Â  Â  indicatorColor: "bg-green-500",
Â  Â  Â  Â  shadowColor: "shadow-green-500/20",
Â  Â  Â  Â  cardBgColor:
Â  Â  Â  Â  Â  Â  "from-green-25 to-green-50 dark:from-green-950/20 dark:to-green-900/20",
Â  Â  Â  Â  label: "All Systems Normal",
Â  Â  };
};

>>>app/dashboard/page.tsx
"use client";
import React from "react";
import { motion } from "motion/react";
import { useState, useEffect } from "react";
import {
Â  TrendingUp,
Â  Building2,
Â  Ship,
Â  Globe,
Â  Shield,
Â  Factory,
Â  BarChart3,
Â  Coins,
Â  Utensils,
Â  Heart,
Â  Leaf,
Â  Zap,
Â  ChevronRight,
Â  Smartphone,
Â  DollarSign,
Â  AlertTriangle,
Â  Lightbulb,
Â  Star,
Â  X,
Â  ChevronDown,
Â  ArrowDown,
Â  Gem,
Â  Wheat,
Â  BriefcaseBusiness,
Â  Earth,
Â  ShoppingCart,
Â  Salad,
Â  Droplet,
Â  Bird,
Â  Award,
Â  Users,
Â  ServerCog,
Â  Ticket,
Â  AlertTriangleIcon,
} from "lucide-react";
import {
Â  loadEnterpriseData,
Â  EnterpriseData,
Â  BusinessUnitData,
} from "@/lib/dataLoader";
import BusinessUnitModal from "@/components/dashboard/modals/BusinessUnitModal";
import SAPModal from "@/components/dashboard/modals/SAPModal";
import ContactsModal from "@/components/dashboard/modals/ContactsModal";
import NSAPCriticalModal from "@/components/dashboard/modals/NSAPCriticalModal";
import SAPCriticalModal from "@/components/dashboard/modals/SAPCriticalModal";
import NSAPDetailsModal from "@/components/dashboard/modals/NSAPDetailsModal";
import ContractsView from "@/components/dashboard/ContractsView";
import ValueSavings from "@/components/dashboard/ValueSavings";
import CoreHub from "@/components/dashboard/CoreHub";
import DashboardSidebarNavigation from "@/components/dashboard/DashboardSidebarNavigation";
import EnterpriseCards from "@/components/dashboard/EnterpriseCards";
import { getEnterpriseStatus, getIconFromName } from "./data";
import HeroSection from "../../components/dashboard/HeroSection";
import StatSection from "../../components/dashboard/StatSection";

export default function DashboardPage() {
Â  const [enterpriseData, setEnterpriseData] = useState<EnterpriseData[]>([]);
Â  const [loading, setLoading] = useState(true);
Â  const [showModal, setShowModal] = useState(false);
Â  const [showNSAPModal, setShowNSAPModal] = useState(false);
Â  const [selectedEnterprise, setSelectedEnterprise] =
Â  Â  useState<EnterpriseData | null>(null);

Â  const [selectedItem, setSelectedItem] = useState<BusinessUnitData | null>(
Â  Â  null
Â  );
Â  const [hoveredAppIndex, setHoveredAppIndex] = useState<number | null>(null);
Â  const [hoveredBusinessUnitIndex, setHoveredBusinessUnitIndex] = useState<
Â  Â  number | null
Â  >(null);
Â  const [showContactsModal, setShowContactsModal] = useState(false);
Â  const [selectedBusinessUnit, setSelectedBusinessUnit] =
Â  Â  useState<BusinessUnitData | null>(null);
Â  const [showSAPModal, setShowSAPModal] = useState(false);
Â  const [selectedSAPEnterprise, setSelectedSAPEnterprise] =
Â  Â  useState<string>("");
Â  const [showP1Modal, setShowP1Modal] = useState(false);
Â  const [selectedP1Enterprise, setSelectedP1Enterprise] =
Â  Â  useState<EnterpriseData | null>(null);
Â  const [showSAPCriticalModal, setShowSAPCriticalModal] = useState(false);
Â  const [selectedSAPCriticalEnterprise, setSelectedSAPCriticalEnterprise] =
Â  Â  useState<EnterpriseData | null>(null);
Â  const [showNSAPCriticalModal, setShowNSAPCriticalModal] = useState(false);
Â  const [selectedNSAPCriticalEnterprise, setSelectedNSAPCriticalEnterprise] =
Â  Â  useState<EnterpriseData | null>(null);

Â  useEffect(() => {
Â  Â  const loadData = async () => {
Â  Â  Â  try {
Â  Â  Â  Â  const data = await loadEnterpriseData();
Â  Â  Â  Â  setEnterpriseData(data);
Â  Â  Â  } catch (error) {
Â  Â  Â  Â  console.error("Failed to load enterprise data:", error);
Â  Â  Â  } finally {
Â  Â  Â  Â  setLoading(false);
Â  Â  Â  }
Â  Â  };

Â  Â  loadData();
Â  }, []);

Â  // Handle scrolling to hash anchor after page load
Â  useEffect(() => {
Â  Â  const handleHashScroll = () => {
Â  Â  Â  const hash = window.location.hash;
Â  Â  Â  if (hash) {
Â  Â  Â  Â  // Remove the # from the hash
Â  Â  Â  Â  const elementId = hash.substring(1);
Â  Â  Â  Â  const element = document.getElementById(elementId);
Â  Â  Â  Â  if (element) {
Â  Â  Â  Â  Â  // Use a timeout to ensure the page is fully rendered
Â  Â  Â  Â  Â  setTimeout(() => {
Â  Â  Â  Â  Â  Â  element.scrollIntoView({ behavior: "smooth", block: "start" });
Â  Â  Â  Â  Â  }, 300);
Â  Â  Â  Â  }
Â  Â  Â  }
Â  Â  };

Â  Â  // Only run after loading is complete
Â  Â  if (!loading) {
Â  Â  Â  handleHashScroll();
Â  Â  }
Â  }, [loading]);

Â  if (loading) {
Â  Â  return (
Â  Â  Â  <div className="min-h-screen bg-gradient-to-br from-gray-50 via-white to-blue-50 dark:from-gray-950 dark:via-gray-900 dark:to-blue-950/20 flex items-center justify-center">
Â  Â  Â  Â  <div className="text-center">
Â  Â  Â  Â  Â  <motion.div
Â  Â  Â  Â  Â  Â  animate={{ rotate: 360 }}
Â  Â  Â  Â  Â  Â  transition={{ duration: 2, repeat: Infinity, ease: "linear" }}
Â  Â  Â  Â  Â  Â  className="inline-flex items-center justify-center w-16 h-16 bg-gradient-to-r from-blue-500 to-green-500 rounded-2xl mb-4 shadow-2xl"
Â  Â  Â  Â  Â  >
Â  Â  Â  Â  Â  Â  <BarChart3 className="w-8 h-8 text-white" />
Â  Â  Â  Â  Â  </motion.div>
Â  Â  Â  Â  Â  <p className="text-lg font-semibold text-gray-600 dark:text-gray-300">
Â  Â  Â  Â  Â  Â  Loading Enterprise Data...
Â  Â  Â  Â  Â  </p>
Â  Â  Â  Â  </div>
Â  Â  Â  </div>
Â  Â  );
Â  }

Â  return (
Â  Â  <div className="min-h-screen bg-gradient-to-br from-gray-50 via-white to-blue-50 dark:from-gray-950 dark:via-gray-900 dark:to-blue-950/20">
Â  Â  Â  {/* Hero Section */}
Â  Â  Â  <HeroSection />

Â  Â  Â  {/* Enterprise Cards Section */}
Â  Â  Â  <EnterpriseCards
Â  Â  Â  Â  enterpriseData={enterpriseData}
Â  Â  Â  Â  hoveredAppIndex={hoveredAppIndex}
Â  Â  Â  Â  setHoveredAppIndex={setHoveredAppIndex}
Â  Â  Â  Â  setSelectedEnterprise={setSelectedEnterprise}
Â  Â  Â  Â  setShowNSAPModal={setShowNSAPModal}
Â  Â  Â  Â  setSelectedSAPEnterprise={setSelectedSAPEnterprise}
Â  Â  Â  Â  setShowSAPModal={setShowSAPModal}
Â  Â  Â  Â  setSelectedNSAPCriticalEnterprise={setSelectedNSAPCriticalEnterprise}
Â  Â  Â  Â  setShowNSAPCriticalModal={setShowNSAPCriticalModal}
Â  Â  Â  Â  setSelectedSAPCriticalEnterprise={setSelectedSAPCriticalEnterprise}
Â  Â  Â  Â  setShowSAPCriticalModal={setShowSAPCriticalModal}
Â  Â  Â  />

Â  Â  Â  {/* NSAP Details Modal */}
Â  Â  Â  <NSAPDetailsModal
Â  Â  Â  Â  showModal={showNSAPModal}
Â  Â  Â  Â  setShowModal={setShowNSAPModal}
Â  Â  Â  Â  selectedEnterprise={selectedEnterprise}
Â  Â  Â  Â  hoveredBusinessUnitIndex={hoveredBusinessUnitIndex}
Â  Â  Â  Â  setHoveredBusinessUnitIndex={setHoveredBusinessUnitIndex}
Â  Â  Â  Â  setSelectedBusinessUnit={setSelectedBusinessUnit}
Â  Â  Â  Â  setShowContactsModal={setShowContactsModal}
Â  Â  Â  />

Â  Â  Â  {/* SAP Details Modal */}
Â  Â  Â  <SAPModal
Â  Â  Â  Â  showSAPModal={showSAPModal}
Â  Â  Â  Â  selectedSAPEnterprise={selectedSAPEnterprise}
Â  Â  Â  Â  onClose={() => setShowSAPModal(false)}
Â  Â  Â  />

Â  Â  Â  {/* SAP Critical Issues Modal */}
Â  Â  Â  <SAPCriticalModal
Â  Â  Â  Â  showModal={showSAPCriticalModal}
Â  Â  Â  Â  setShowModal={setShowSAPCriticalModal}
Â  Â  Â  Â  selectedEnterprise={selectedSAPCriticalEnterprise}
Â  Â  Â  />

Â  Â  Â  {/* NSAP Critical Issues Modal */}
Â  Â  Â  <NSAPCriticalModal
Â  Â  Â  Â  showModal={showNSAPCriticalModal}
Â  Â  Â  Â  setShowModal={setShowNSAPCriticalModal}
Â  Â  Â  Â  selectedEnterprise={selectedNSAPCriticalEnterprise}
Â  Â  Â  />

Â  Â  Â  {/* Contacts Modal */}
Â  Â  Â  <ContactsModal
Â  Â  Â  Â  showModal={showContactsModal}
Â  Â  Â  Â  setShowModal={setShowContactsModal}
Â  Â  Â  Â  selectedBusinessUnit={selectedBusinessUnit}
Â  Â  Â  />

Â  Â  Â  {/* Core Hub Section*/}
Â  Â  Â  <div id="core-hub">
Â  Â  Â  Â  <CoreHub />
Â  Â  Â  </div>

Â  Â  Â  {/* Value Savings Section*/}
Â  Â  Â  <div id="value-capture">
Â  Â  Â  Â  <ValueSavings />
Â  Â  Â  </div>

Â  Â  Â  {/* Contracts View Section*/}
Â  Â  Â  {/* <div id="contracts">
Â  Â  Â  Â  <ContractsView />
Â  Â  Â  </div> */}

Â  Â  Â  {/* Stats Section Section*/}
Â  Â  Â  <StatSection />

Â  Â  Â  {/* Sidebar Navigation */}
Â  Â  Â  <DashboardSidebarNavigation />
Â  Â  </div>
Â  );
}

